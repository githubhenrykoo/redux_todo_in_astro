import{j as e}from"./jsx-dev-runtime.ndqpvE2b.js";import{r as i}from"./index.DKKB-h0h.js";import{createClient as D}from"./client.BqYALPpZ.js";const A=({config:s={},renderUserInfo:d,customLoginButton:m,customLogoutButton:f})=>{const[t,b]=i.useState(null),[n,c]=i.useState(null),[r,l]=i.useState(!1),[h,u]=i.useState(null);i.useEffect(()=>{if(typeof window<"u"&&s.clientId){const o=D({clientId:s.clientId,redirectUri:s.redirectUri,scopes:s.scopes,baseUrl:s.baseUrl,storageKey:s.storageKey});b(o)}},[s]),i.useEffect(()=>{(async()=>{if(t)try{const a=await t.getUserInfo();c(a),!a&&window.location.search.includes("code=")&&await _()}catch(a){console.error("Failed to get user info:",a),c(null)}})()},[t]);const _=async()=>{try{const a=new URLSearchParams(window.location.search).get("code");if(a){l(!0),await t.handleCallback(a);const g=await t.getUserInfo();c(g),window.history.replaceState({},document.title,window.location.pathname)}}catch(o){console.error("Authentication callback failed:",o),u("Authentication failed. Please try again.")}finally{l(!1)}},x=async()=>{if(t){l(!0),u(null);try{await t.login()}catch(o){console.error("Login failed",o),u("Login failed. Please try again.")}finally{l(!1)}}},N=async()=>{if(t){l(!0),u(null);try{await t.logout(),c(null)}catch(o){console.error("Logout failed",o),u("Logout failed. Please try again.")}finally{l(!1)}}},k=()=>d?d(n):n?e.jsxDEV("div",{className:"flex items-center space-x-2",children:[n.picture?e.jsxDEV("img",{src:n.picture,alt:n.name||"User",className:"w-8 h-8 rounded-full object-cover"},void 0,!1,{fileName:"/Users/Henrykoo/Documents/redux_todo_in_astro/src/components/auth/AuthentikPanel.jsx",lineNumber:133,columnNumber:11},void 0):e.jsxDEV("div",{className:"w-8 h-8 rounded-full bg-blue-100 flex items-center justify-center text-blue-600",children:n.name?n.name.charAt(0).toUpperCase():"ðŸ‘¤"},void 0,!1,{fileName:"/Users/Henrykoo/Documents/redux_todo_in_astro/src/components/auth/AuthentikPanel.jsx",lineNumber:139,columnNumber:11},void 0),e.jsxDEV("div",{children:[e.jsxDEV("p",{className:"text-sm font-medium",children:n.name||"Guest"},void 0,!1,{fileName:"/Users/Henrykoo/Documents/redux_todo_in_astro/src/components/auth/AuthentikPanel.jsx",lineNumber:144,columnNumber:11},void 0),e.jsxDEV("p",{className:"text-xs text-muted-foreground",children:n.email||"Not logged in"},void 0,!1,{fileName:"/Users/Henrykoo/Documents/redux_todo_in_astro/src/components/auth/AuthentikPanel.jsx",lineNumber:145,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/Henrykoo/Documents/redux_todo_in_astro/src/components/auth/AuthentikPanel.jsx",lineNumber:143,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/Henrykoo/Documents/redux_todo_in_astro/src/components/auth/AuthentikPanel.jsx",lineNumber:131,columnNumber:7},void 0):null,p=()=>m?m(x,r):e.jsxDEV("button",{onClick:x,disabled:r,className:`
          flex items-center justify-center w-8 h-8 rounded-full transition-colors
          ${r?"bg-gray-200 cursor-not-allowed":"bg-blue-100 text-blue-600 hover:bg-blue-200"}
        `,"aria-label":"Login",children:r?e.jsxDEV("svg",{xmlns:"http://www.w3.org/2000/svg",className:"animate-spin h-5 w-5 text-blue-600",fill:"none",viewBox:"0 0 24 24",children:[e.jsxDEV("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"},void 0,!1,{fileName:"/Users/Henrykoo/Documents/redux_todo_in_astro/src/components/auth/AuthentikPanel.jsx",lineNumber:178,columnNumber:13},void 0),e.jsxDEV("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},void 0,!1,{fileName:"/Users/Henrykoo/Documents/redux_todo_in_astro/src/components/auth/AuthentikPanel.jsx",lineNumber:186,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/Henrykoo/Documents/redux_todo_in_astro/src/components/auth/AuthentikPanel.jsx",lineNumber:172,columnNumber:11},void 0):e.jsxDEV("span",{children:"ðŸ”‘"},void 0,!1,{fileName:"/Users/Henrykoo/Documents/redux_todo_in_astro/src/components/auth/AuthentikPanel.jsx",lineNumber:193,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/Henrykoo/Documents/redux_todo_in_astro/src/components/auth/AuthentikPanel.jsx",lineNumber:160,columnNumber:7},void 0),y=()=>f?f(N,r):e.jsxDEV("button",{onClick:N,disabled:r,className:`
          flex items-center justify-center w-8 h-8 rounded-full transition-colors
          ${r?"bg-gray-200 cursor-not-allowed":"hover:bg-gray-200"}
        `,"aria-label":"Logout",children:r?e.jsxDEV("svg",{xmlns:"http://www.w3.org/2000/svg",className:"animate-spin h-5 w-5 text-gray-600",fill:"none",viewBox:"0 0 24 24",children:[e.jsxDEV("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"},void 0,!1,{fileName:"/Users/Henrykoo/Documents/redux_todo_in_astro/src/components/auth/AuthentikPanel.jsx",lineNumber:223,columnNumber:13},void 0),e.jsxDEV("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},void 0,!1,{fileName:"/Users/Henrykoo/Documents/redux_todo_in_astro/src/components/auth/AuthentikPanel.jsx",lineNumber:231,columnNumber:13},void 0)]},void 0,!0,{fileName:"/Users/Henrykoo/Documents/redux_todo_in_astro/src/components/auth/AuthentikPanel.jsx",lineNumber:217,columnNumber:11},void 0):e.jsxDEV("span",{children:"ðŸšª"},void 0,!1,{fileName:"/Users/Henrykoo/Documents/redux_todo_in_astro/src/components/auth/AuthentikPanel.jsx",lineNumber:238,columnNumber:11},void 0)},void 0,!1,{fileName:"/Users/Henrykoo/Documents/redux_todo_in_astro/src/components/auth/AuthentikPanel.jsx",lineNumber:205,columnNumber:7},void 0),j=()=>h?e.jsxDEV("div",{className:"text-red-500 text-xs mt-1",children:h},void 0,!1,{fileName:"/Users/Henrykoo/Documents/redux_todo_in_astro/src/components/auth/AuthentikPanel.jsx",lineNumber:249,columnNumber:7},void 0):null;return e.jsxDEV("div",{className:"flex items-center space-x-2",children:[n?e.jsxDEV(e.Fragment,{children:[k(),y()]},void 0,!0,{fileName:"/Users/Henrykoo/Documents/redux_todo_in_astro/src/components/auth/AuthentikPanel.jsx",lineNumber:258,columnNumber:9},void 0):p(),j()]},void 0,!0,{fileName:"/Users/Henrykoo/Documents/redux_todo_in_astro/src/components/auth/AuthentikPanel.jsx",lineNumber:256,columnNumber:5},void 0)};export{A as default};
