import{j as o}from"./jsx-dev-runtime.ndqpvE2b.js";import{r as a}from"./index.DKKB-h0h.js";import{s as g}from"./store.WvhFAbWr.js";import"./contentSlice.DBLxFn2W.js";const S=()=>{const[m,r]=a.useState(""),[u,N]=a.useState(null),[c,p]=a.useState(null),[d,l]=a.useState(null),i=()=>{try{const s=g.getState();return console.log("Retrieved Redux state:",s),console.log("Redux state contains keys:",Object.keys(s)),p(s),s}catch(s){return console.error("Error accessing store state:",s),{error:"Unable to access store state"}}};a.useEffect(()=>{i()},[]);const h=async s=>{s.preventDefault(),r("Sending state to server..."),l(null);try{const e=i();console.log("Current store state type:",typeof e),console.log("Current store state keys:",Object.keys(e));const t={timestamp:new Date().toISOString()};"theme"in e&&(t.theme=e.theme),"user"in e&&(t.user=e.user),"content"in e&&(t.content=e.content),"todo"in e&&(t.todo=e.todo),Object.keys(t).length===1&&(t.basic={availableKeys:Object.keys(e)}),console.log("Sending simplified payload:",t);const b=JSON.stringify(t);console.log("Payload JSON string length:",b.length);const f=await fetch("/api/submit",{method:"POST",headers:{"Content-Type":"application/json"},body:b});console.log("Response status:",f.status);const x=await f.text();console.log("Raw response text:",x);try{const n=JSON.parse(x);console.log("Parsed response data:",n),N(n),n.hash?(l(n.hash),r(`State sent successfully! Hash: ${n.hash}`)):r(n.message||"State sent successfully")}catch(n){console.error("Error parsing response:",n),r("Server responded but sent invalid JSON")}}catch(e){console.error("Request error:",e),r(e instanceof Error?`Error: ${e.message}`:"Unknown error occurred")}};return o.jsxDEV("div",{className:"max-w-md mx-auto p-6 bg-white rounded-lg shadow-md",children:[o.jsxDEV("form",{onSubmit:h,className:"space-y-4",children:[o.jsxDEV("button",{type:"submit",className:"w-full py-2 rounded-md text-white font-semibold bg-blue-500 hover:bg-blue-600 active:bg-blue-700",children:"Send Redux State to Server"},void 0,!1,{fileName:"/Users/Henrykoo/Documents/redux_todo_in_astro/src/components/CommunicationTest.tsx",lineNumber:100,columnNumber:9},void 0),o.jsxDEV("button",{type:"button",onClick:i,className:"w-full py-2 rounded-md text-white font-semibold bg-gray-500 hover:bg-gray-600 active:bg-gray-700",children:"Refresh State"},void 0,!1,{fileName:"/Users/Henrykoo/Documents/redux_todo_in_astro/src/components/CommunicationTest.tsx",lineNumber:107,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/Henrykoo/Documents/redux_todo_in_astro/src/components/CommunicationTest.tsx",lineNumber:99,columnNumber:7},void 0),m&&o.jsxDEV("div",{className:"mt-4 p-3 bg-gray-100 rounded text-center",children:m},void 0,!1,{fileName:"/Users/Henrykoo/Documents/redux_todo_in_astro/src/components/CommunicationTest.tsx",lineNumber:117,columnNumber:9},void 0),d&&o.jsxDEV("div",{className:"mt-4 p-3 bg-blue-50 rounded border border-blue-200",children:[o.jsxDEV("h3",{className:"font-semibold mb-1",children:"Created Card Hash:"},void 0,!1,{fileName:"/Users/Henrykoo/Documents/redux_todo_in_astro/src/components/CommunicationTest.tsx",lineNumber:124,columnNumber:11},void 0),o.jsxDEV("div",{className:"bg-blue-100 p-2 rounded font-mono text-sm overflow-auto select-all",children:d},void 0,!1,{fileName:"/Users/Henrykoo/Documents/redux_todo_in_astro/src/components/CommunicationTest.tsx",lineNumber:125,columnNumber:11},void 0),o.jsxDEV("p",{className:"text-xs text-gray-500 mt-1",children:"Use this hash to look up the stored data using the Card Viewer below"},void 0,!1,{fileName:"/Users/Henrykoo/Documents/redux_todo_in_astro/src/components/CommunicationTest.tsx",lineNumber:128,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/Henrykoo/Documents/redux_todo_in_astro/src/components/CommunicationTest.tsx",lineNumber:123,columnNumber:9},void 0),u&&o.jsxDEV("div",{className:"mt-4 p-3 bg-gray-50 rounded border border-gray-200",children:[o.jsxDEV("h3",{className:"font-semibold mb-2",children:"Server Response:"},void 0,!1,{fileName:"/Users/Henrykoo/Documents/redux_todo_in_astro/src/components/CommunicationTest.tsx",lineNumber:136,columnNumber:11},void 0),o.jsxDEV("pre",{className:"bg-gray-100 p-2 rounded text-sm overflow-auto",children:JSON.stringify(u,null,2)},void 0,!1,{fileName:"/Users/Henrykoo/Documents/redux_todo_in_astro/src/components/CommunicationTest.tsx",lineNumber:137,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/Henrykoo/Documents/redux_todo_in_astro/src/components/CommunicationTest.tsx",lineNumber:135,columnNumber:9},void 0),o.jsxDEV("div",{className:"mt-4 p-3 bg-gray-50 rounded border border-gray-200",children:[o.jsxDEV("h3",{className:"font-semibold mb-2",children:"Current Redux State:"},void 0,!1,{fileName:"/Users/Henrykoo/Documents/redux_todo_in_astro/src/components/CommunicationTest.tsx",lineNumber:144,columnNumber:9},void 0),o.jsxDEV("pre",{className:"bg-gray-100 p-2 rounded text-sm overflow-auto max-h-60",children:c?JSON.stringify(c,null,2):"Loading state..."},void 0,!1,{fileName:"/Users/Henrykoo/Documents/redux_todo_in_astro/src/components/CommunicationTest.tsx",lineNumber:145,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/Henrykoo/Documents/redux_todo_in_astro/src/components/CommunicationTest.tsx",lineNumber:143,columnNumber:7},void 0)]},void 0,!0,{fileName:"/Users/Henrykoo/Documents/redux_todo_in_astro/src/components/CommunicationTest.tsx",lineNumber:98,columnNumber:5},void 0)};export{S as CommunicationTest};
