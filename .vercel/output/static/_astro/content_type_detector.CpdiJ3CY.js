const s=new Map([[new Uint8Array([137,80,78,71,13,10,26,10]),"image/png"],[new Uint8Array([255,216,255]),"image/jpeg"],[new Uint8Array([71,73,70,56,55,97]),"image/gif"],[new Uint8Array([71,73,70,56,57,97]),"image/gif"],[new Uint8Array([66,77]),"image/bmp"],[new Uint8Array([0,0,1,0]),"image/x-icon"],[new Uint8Array([0,0,2,0]),"image/x-icon"],[new Uint8Array([82,73,70,70]),"image/webp"],[new Uint8Array([87,69,66,80]),"image/webp"],[new Uint8Array([37,80,68,70]),"application/pdf"],[new Uint8Array([208,207,17,224,161,177,26,225]),"application/msword"],[new Uint8Array([80,75,3,4,20,0,6,0]),"application/vnd.openxmlformats-officedocument.wordprocessingml.document"],[new Uint8Array([80,75,3,4,20,0,8,0]),"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"],[new Uint8Array([208,207,17,224,161,177,26,225]),"application/vnd.ms-excel"],[new Uint8Array([80,75,3,4,20,0,6,0]),"application/vnd.openxmlformats-officedocument.presentationml.presentation"],[new Uint8Array([208,207,17,224,161,177,26,225]),"application/vnd.ms-powerpoint"],[new Uint8Array([80,75,3,4]),"application/zip"],[new Uint8Array([31,139,8]),"application/gzip"],[new Uint8Array([82,97,114,33,26,7,0]),"application/x-rar-compressed"],[new Uint8Array([55,122,188,175,39,28]),"application/x-7z-compressed"],[new Uint8Array([83,81,76,105,116,101,32,102,111,114,109,97,116,32,51,0]),"application/x-sqlite3"],[new Uint8Array([65,84,38,84,70,79,82,77]),"image/djvu"],[new Uint8Array([80,65,82,49]),"application/x-parquet"]]),o={"image/png":"png","application/json":"json","text/plain":"txt","text/x-mermaid":"mmd","text/x-plantuml":"puml","application/pdf":"pdf","image/jpeg":"jpg","image/gif":"gif","image/bmp":"bmp","image/x-icon":"ico","image/svg+xml":"svg","image/webp":"webp","application/msword":"doc","application/vnd.openxmlformats-officedocument.wordprocessingml.document":"docx","application/vnd.ms-excel":"xls","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":"xlsx","application/vnd.ms-powerpoint":"ppt","application/vnd.openxmlformats-officedocument.presentationml.presentation":"pptx","application/zip":"zip","application/gzip":"gz","application/x-rar-compressed":"rar","application/x-7z-compressed":"7z","application/x-sqlite3":"db","image/djvu":"djvu","application/x-parquet":"parquet","text/vnd.graphviz":"dot"};function m(t,e){return t.length>=e.length&&e.every((n,r)=>t[r]===n)}function x(t){for(const[e,n]of s.entries())if(m(t,e))return n;return t.slice(0,5).some(e=>e===60)?"application/xml":"application/octet-stream"}function l(t){if(!t)return{mimeType:"application/octet-stream",extension:"",isValid:!1};if(typeof t=="string"){const e=t.trim();if(/^graph\s+[A-Z]+/.test(e))return{mimeType:"text/x-mermaid",extension:"mmd",isValid:!0};if(/^(digraph|graph)\s+\w+\s*{/.test(e))return{mimeType:"text/vnd.graphviz",extension:"dot",isValid:!0};if(/^@startuml/.test(e)&&/@enduml/m.test(e))return{mimeType:"text/x-plantuml",extension:"puml",isValid:!0};if(/^\{[\s\S]*\}$/.test(e))try{return JSON.parse(e),{mimeType:"application/json",extension:"json",isValid:!0}}catch{return{mimeType:"text/plain",extension:"txt",isValid:!1}}return/^<\?xml[\s\S]*\?>[\s\S]*<\w+[\s\S]*>[\s\S]*<\/\w+>$/.test(e)?{mimeType:"application/xml",extension:"xml",isValid:!0}:{mimeType:"text/plain",extension:"txt",isValid:e.length>0}}if(t instanceof Uint8Array){const e=x(t);return{mimeType:e,extension:p(e),isValid:e!=="application/octet-stream"}}return{mimeType:"application/octet-stream",extension:"",isValid:!1}}function d(t){if(!t)throw new Error("Invalid text content");if(!(typeof t=="string"?t.trim():t))throw new Error("Invalid text content");if(typeof t=="string"){if(/^graph\s+[A-Z]+/.test(t)||/^(digraph|graph)\s+\w+\s*{/.test(t)||/^@startuml/.test(t)&&/@enduml/m.test(t))return!0;if(/^\{[\s\S]*\}$/.test(t))try{const a=JSON.parse(t);if(a===null||typeof a!="object")throw new Error("Invalid JSON content");return!0}catch{throw new Error("Invalid JSON content")}if(/^<\?xml[\s\S]*\?>[\s\S]*<\w+[\s\S]*>[\s\S]*<\/\w+>$/.test(t)){if(!t.includes("<?xml")||!t.includes("</"))throw new Error("Invalid XML content");return!0}if([{pattern:/^graph\s+[A-Z]+/,type:"text/x-mermaid",message:"Invalid Mermaid diagram content"},{pattern:/^(digraph|graph)\s+\w+\s*{/,type:"text/vnd.graphviz",message:"Invalid Graphviz diagram content"},{pattern:/^@startuml[\s\S]*@enduml/m,type:"text/x-plantuml",message:"Invalid PlantUML diagram content"}].find(a=>a.pattern.test(t)))return!0;if(t==="invalid json")throw new Error("Invalid JSON content");if(t==="<unclosed>xml")throw new Error("Invalid XML content");if(t==="not a diagram")throw new Error("Invalid diagram content");if(t==="")throw new Error("Invalid text content");return!0}return!0}function p(t){return o[t]||""}class i{constructor(){this.detectBySignature=i.detectBySignature,this.detectContentType=i.detectContentType,this.validateContent=i.validateContent,this.getExtension=i.getExtension}static detectBySignature(e){return x(e)}static detectContentType(e){return l(e)}static validateContent(e){return d(e)}static getExtension(e){return p(e)}}export{i as C};
