import{j as n}from"./jsx-dev-runtime.ndqpvE2b.js";import{r}from"./index.DKKB-h0h.js";const S=({className:v=""})=>{const[p,o]=r.useState([{text:"Terminal",type:"header"},{text:"Connecting to terminal server...",type:"info"}]),[l,i]=r.useState(""),[m,x]=r.useState(!1),[N,f]=r.useState(null),[a,D]=r.useState([]),[h,y]=r.useState(-1),c=r.useRef(null),d=r.useRef(null),j=r.useRef(null),s=r.useRef(null);r.useEffect(()=>(u(),()=>{c.current&&c.current.close(),s.current&&clearTimeout(s.current)}),[]),r.useEffect(()=>{d.current&&(d.current.scrollTop=d.current.scrollHeight)},[p]);const u=()=>{try{s.current&&clearTimeout(s.current);const e=new WebSocket("ws://localhost:3001");c.current=e,e.onopen=()=>{x(!0),f(null),o(t=>[...t,{text:"Connected to terminal server",type:"success"}])},e.onmessage=t=>{const _=JSON.parse(t.data);_.type==="output"&&_.data.split(`
`).forEach(g=>{g.trim()&&o(U=>[...U,{text:g,type:"terminal"}])})},e.onerror=()=>{x(!1),f("Failed to connect to terminal server. Make sure the server is running."),o(t=>[...t,{text:"Error: Failed to connect to terminal server",type:"error"},{text:"Make sure the server is running at ws://localhost:3001",type:"error"},{text:"Attempting to reconnect in 5 seconds...",type:"info"}]),s.current=setTimeout(()=>{o(t=>[...t,{text:"Attempting to reconnect...",type:"info"}]),u()},5e3)},e.onclose=()=>{x(!1),o(t=>[...t,{text:"Disconnected from terminal server",type:"error"},{text:"Attempting to reconnect in 5 seconds...",type:"info"}]),s.current=setTimeout(()=>{o(t=>[...t,{text:"Attempting to reconnect...",type:"info"}]),u()},5e3)}}catch(e){console.error("Terminal connection error:",e),f(`Terminal connection error: ${e.message}`),s.current=setTimeout(()=>{o(t=>[...t,{text:"Attempting to reconnect...",type:"info"}]),u()},5e3)}},k=e=>{i(e.target.value)},E=e=>{e.key==="Enter"?H():e.key==="ArrowUp"?(e.preventDefault(),b(-1)):e.key==="ArrowDown"&&(e.preventDefault(),b(1))},b=e=>{if(a.length===0)return;const t=h+e;t>=-1&&t<a.length&&(y(t),i(t===-1?"":a[a.length-1-t]))},H=()=>{!l.trim()||!m||(D(e=>[...e,l]),y(-1),o(e=>[...e,{text:`$ ${l}`,type:"command"}]),c.current&&c.current.readyState===WebSocket.OPEN&&c.current.send(JSON.stringify({type:"input",data:l+`
`})),i(""))},w=()=>{o([{text:"Terminal cleared",type:"info"}])};return n.jsxDEV("div",{className:`h-full w-full flex flex-col bg-gray-900 text-gray-200 font-mono ${v}`,children:[n.jsxDEV("div",{className:"p-2 bg-gray-800 border-b border-gray-700 flex items-center",children:[n.jsxDEV("div",{className:"flex space-x-2 mr-4",children:[n.jsxDEV("div",{className:"w-3 h-3 rounded-full bg-red-500"},void 0,!1,{fileName:"/Users/Henrykoo/Documents/redux_todo_in_astro/src/components/panels/xterm.jsx",lineNumber:180,columnNumber:11},void 0),n.jsxDEV("div",{className:"w-3 h-3 rounded-full bg-yellow-500"},void 0,!1,{fileName:"/Users/Henrykoo/Documents/redux_todo_in_astro/src/components/panels/xterm.jsx",lineNumber:181,columnNumber:11},void 0),n.jsxDEV("div",{className:"w-3 h-3 rounded-full bg-green-500"},void 0,!1,{fileName:"/Users/Henrykoo/Documents/redux_todo_in_astro/src/components/panels/xterm.jsx",lineNumber:182,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/Henrykoo/Documents/redux_todo_in_astro/src/components/panels/xterm.jsx",lineNumber:179,columnNumber:9},void 0),n.jsxDEV("div",{className:"text-center flex-grow",children:"Terminal"},void 0,!1,{fileName:"/Users/Henrykoo/Documents/redux_todo_in_astro/src/components/panels/xterm.jsx",lineNumber:184,columnNumber:9},void 0),n.jsxDEV("button",{onClick:w,className:"px-2 py-1 text-xs bg-gray-700 hover:bg-gray-600 rounded",children:"Clear"},void 0,!1,{fileName:"/Users/Henrykoo/Documents/redux_todo_in_astro/src/components/panels/xterm.jsx",lineNumber:185,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/Henrykoo/Documents/redux_todo_in_astro/src/components/panels/xterm.jsx",lineNumber:178,columnNumber:7},void 0),N&&n.jsxDEV("div",{className:"bg-red-900 text-red-100 p-2 text-sm",children:[N,n.jsxDEV("button",{onClick:u,className:"ml-2 px-2 py-0.5 bg-red-800 hover:bg-red-700 rounded text-xs",children:"Retry"},void 0,!1,{fileName:"/Users/Henrykoo/Documents/redux_todo_in_astro/src/components/panels/xterm.jsx",lineNumber:196,columnNumber:11},void 0)]},void 0,!0,{fileName:"/Users/Henrykoo/Documents/redux_todo_in_astro/src/components/panels/xterm.jsx",lineNumber:194,columnNumber:9},void 0),n.jsxDEV("div",{ref:d,className:"flex-1 p-2 overflow-y-auto",children:p.map((e,t)=>n.jsxDEV("div",{className:`mb-1 ${e.type==="error"?"text-red-400":e.type==="info"?"text-blue-400":e.type==="success"?"text-green-400":e.type==="command"?"text-yellow-400 font-bold":e.type==="header"?"text-white font-bold text-lg mb-2":"text-gray-200"}`,children:e.text},t,!1,{fileName:"/Users/Henrykoo/Documents/redux_todo_in_astro/src/components/panels/xterm.jsx",lineNumber:210,columnNumber:11},void 0))},void 0,!1,{fileName:"/Users/Henrykoo/Documents/redux_todo_in_astro/src/components/panels/xterm.jsx",lineNumber:205,columnNumber:7},void 0),n.jsxDEV("div",{className:"p-2 border-t border-gray-700 flex items-center",children:[n.jsxDEV("span",{className:"text-green-400 mr-2",children:"$"},void 0,!1,{fileName:"/Users/Henrykoo/Documents/redux_todo_in_astro/src/components/panels/xterm.jsx",lineNumber:227,columnNumber:9},void 0),n.jsxDEV("input",{ref:j,type:"text",value:l,onChange:k,onKeyDown:E,className:"flex-grow bg-transparent outline-none text-white",placeholder:m?"Enter command...":"Connecting...",disabled:!m,autoFocus:!0},void 0,!1,{fileName:"/Users/Henrykoo/Documents/redux_todo_in_astro/src/components/panels/xterm.jsx",lineNumber:228,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/Henrykoo/Documents/redux_todo_in_astro/src/components/panels/xterm.jsx",lineNumber:226,columnNumber:7},void 0),n.jsxDEV("div",{className:"p-1 bg-gray-800 text-xs text-gray-500 flex justify-between",children:[n.jsxDEV("span",{children:m?"Connected":"Disconnected"},void 0,!1,{fileName:"/Users/Henrykoo/Documents/redux_todo_in_astro/src/components/panels/xterm.jsx",lineNumber:242,columnNumber:9},void 0),n.jsxDEV("span",{children:"Use ↑↓ for history"},void 0,!1,{fileName:"/Users/Henrykoo/Documents/redux_todo_in_astro/src/components/panels/xterm.jsx",lineNumber:243,columnNumber:9},void 0)]},void 0,!0,{fileName:"/Users/Henrykoo/Documents/redux_todo_in_astro/src/components/panels/xterm.jsx",lineNumber:241,columnNumber:7},void 0)]},void 0,!0,{fileName:"/Users/Henrykoo/Documents/redux_todo_in_astro/src/components/panels/xterm.jsx",lineNumber:177,columnNumber:5},void 0)};export{S as default};
