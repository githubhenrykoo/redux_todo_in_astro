# Git Activity Log - Henry Koo
Generated at: Thu Apr  3 00:42:49 UTC 2025
## Changes by Henry Koo
```diff
commit f17e3138b4f73a7983ff76b4dd5d0eeb3a96275a
Author: Henry Koo <lckoo1230@gmail.com>
Date:   Wed Apr 2 11:23:41 2025 +0800

    mqtt display

diff --git a/mqtt_dashboard_darkmode_energypro_fixed.html b/mqtt_dashboard_darkmode_energypro_fixed.html
new file mode 100644
index 0000000..e1e5899
--- /dev/null
+++ b/mqtt_dashboard_darkmode_energypro_fixed.html
@@ -0,0 +1,270 @@
+
+<!DOCTYPE html>
+
+<html>
+<head>
+<meta charset="utf-8"/>
+<title>MQTT Dashboard</title>
+<script src="https://unpkg.com/mqtt/dist/mqtt.min.js"></script>
+<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
+<style>
+    body {
+      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
+      background-color: #121212;
+      color: #e0e0e0;
+      margin: 0;
+      padding: 0;
+    }
+
+    .container {
+      max-width: 900px;
+      margin: auto;
+      padding: 30px;
+    }
+
+    h2, h3 {
+      text-align: center;
+      color: #03dac6;
+    }
+
+    canvas {
+      width: 100%;
+      background-color: #1f1f1f;
+      border-radius: 8px;
+      margin: 20px 0;
+      padding: 10px;
+    }
+
+    .btn-group {
+      display: flex;
+      justify-content: center;
+      gap: 20px;
+      margin-bottom: 30px;
+    }
+
+    button {
+      padding: 12px 24px;
+      font-size: 16px;
+      border-radius: 6px;
+      border: none;
+      cursor: pointer;
+      transition: all 0.3s ease;
+    }
+
+    .on {
+      background-color: #00c853;
+      color: white;
+    }
+
+    .on:hover {
+      background-color: #00b248;
+    }
+
+    .off {
+      background-color: #d50000;
+      color: white;
+    }
+
+    .off:hover {
+      background-color: #b71c1c;
+    }
+
+    input[type="text"] {
+      padding: 12px;
+      width: 70%;
+      max-width: 400px;
+      border-radius: 6px;
+      border: none;
+      margin-right: 10px;
+      font-size: 16px;
+    }
+
+    .data-block {
+      display: grid;
+      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
+      gap: 15px;
+      margin-top: 20px;
+    }
+
+    .data-card {
+      background-color: #1e1e1e;
+      padding: 15px;
+      border-radius: 8px;
+      box-shadow: 0 0 10px #000;
+      text-align: center;
+    }
+
+    .data-card span {
+      display: block;
+      font-size: 18px;
+      font-weight: bold;
+      color: #ffffff;
+    }
+
+    #status {
+      text-align: center;
+      font-style: italic;
+      margin-top: 10px;
+      margin-bottom: 20px;
+    }
+  
+.energy-tiles {
+  display: flex;
+  flex-wrap: wrap;
+  justify-content: space-around;
+  gap: 15px;
+  margin: 30px 0;
+}
+.tile {
+  flex: 1 1 150px;
+  padding: 20px;
+  border-radius: 10px;
+  color: white;
+  text-align: center;
+  box-shadow: 0 0 10px #000;
+}
+.tile h4 {
+  margin-bottom: 10px;
+  font-size: 16px;
+  font-weight: 500;
+}
+.tile .value {
+  font-size: 28px;
+  font-weight: bold;
+}
+.tile.blue { background-color: #2196f3; }
+.tile.green { background-color: #4caf50; }
+.tile.yellow { background-color: #ffeb3b; color: #000; }
+.tile.orange { background-color: #ff9800; }
+.tile.purple { background-color: #9c27b0; }
+
+.control-bar {
+  display: flex;
+  flex-wrap: wrap;
+  justify-content: center;
+  gap: 10px;
+  margin: 30px 0;
+  align-items: center;
+}
+.control-bar input[type="text"] {
+  flex: 1 1 200px;
+  min-width: 150px;
+}
+.control-bar button {
+  flex: 0 0 auto;
+}
+</style>
+</head>
+<body><div class="container">
+<h2>MQTT Dashboard - Dark Mode</h2>
+<p id="status">Connecting to MQTT Broker...</p>
+<canvas id="tempChart"></canvas>
+<p>Current Temperature: <span id="currentTemp">--</span> ¬∞C</p>
+<h3>Data Energy Meter</h3>
+<div class="control-bar"><button class="on" onclick="toggleLED('1')">Nyalakan LED</button><button class="off" onclick="toggleLED('0')">Matikan LED</button><input id="customText" placeholder="Tulis pesan..." type="text"/><button onclick="sendText()">Kirim</button></div><div class="energy-tiles">
+<div class="tile blue">
+<h4>Tegangan</h4>
+<div class="value"><span id="volt">--</span> V</div>
+</div>
+<div class="tile green">
+<h4>Arus</h4>
+<div class="value"><span id="ampere">--</span> A</div>
+</div>
+<div class="tile yellow">
+<h4>Daya</h4>
+<div class="value"><span id="power">--</span> W</div>
+</div>
+<div class="tile orange">
+<h4>KWH</h4>
+<div class="value"><span id="kwh">--</span> kWh</div>
+</div>
+<div class="tile purple">
+<h4>Power Factor</h4>
+<div class="value"><span id="pf">--</span></div>
+</div>
+</div>
+<h3>Kirim Pesan Manual</h3>
+<script>
+    const broker = 'wss://1115a4b6fe5c40e588a3a85468f3c8be.s1.eu.hivemq.cloud:8884/mqtt';
+    const options = {
+      connectTimeout: 4000,
+      clientId: 'webClient_' + Math.random().toString(16).substr(2, 8),
+      username: 'testing',
+      password: 'Testing123',
+      clean: true,
+    };
+
+    const client = mqtt.connect(broker, options);
+
+    client.on('connect', () => {
+      document.getElementById('status').innerText = '‚úÖ Connected to MQTT Broker';
+      client.subscribe('sensor/temperature');
+      ['sensor/tegangan', 'sensor/arus', 'sensor/daya', 'sensor/kwh', 'sensor/pf'].forEach(topic => {
+        client.subscribe(topic);
+      });
+    });
+
+    client.on('error', err => {
+      document.getElementById('status').innerText = '‚ùå MQTT Connection Error';
+      console.error(err);
+    });
+
+    function toggleLED(state) {
+      client.publish('control/led', state);
+    }
+
+    function sendText() {
+      const text = document.getElementById('customText').value;
+      if (text.trim() !== '') {
+        client.publish('control/tulisan', text); // Ganti topik sesuai kebutuhan
+        document.getElementById('customText').value = '';
+      }
+    }
+
+    const ctx = document.getElementById('tempChart').getContext('2d');
+    const tempData = {
+      labels: [],
+      datasets: [{
+        label: 'Temperature (¬∞C)',
+        data: [],
+        fill: false,
+        borderColor: '#03dac5',
+        tension: 0.3
+      }]
+    };
+
+    const tempChart = new Chart(ctx, {
+      type: 'line',
+      data: tempData,
+      options: {
+        responsive: true,
+        scales: {
+          x: { title: { display: true, text: 'Waktu' } },
+          y: { title: { display: true, text: 'Suhu (¬∞C)' }, suggestedMin: 20, suggestedMax: 40 }
+        }
+      }
+    });
+
+    client.on('message', (topic, message) => {
+      const msg = message.toString();
+      const now = new Date().toLocaleTimeString();
+      if (topic === 'sensor/temperature') {
+        const suhu = parseFloat(msg);
+        document.getElementById('currentTemp').innerText = suhu;
+        tempData.labels.push(now);
+        tempData.datasets[0].data.push(suhu);
+        if (tempData.labels.length > 20) {
+          tempData.labels.shift();
+          tempData.datasets[0].data.shift();
+        }
+        tempChart.update();
+      }
+      if (topic === 'sensor/tegangan') document.getElementById('volt').innerText = msg;
+      if (topic === 'sensor/arus') document.getElementById('ampere').innerText = msg;
+      if (topic === 'sensor/daya') document.getElementById('power').innerText = msg;
+      if (topic === 'sensor/kwh') document.getElementById('kwh').innerText = msg;
+      if (topic === 'sensor/pf') document.getElementById('pf').innerText = msg;
+    });
+  </script>
+</div></body>
+</html>
diff --git a/package.json b/package.json
index 4a775bf..5f3b8c4 100644
--- a/package.json
+++ b/package.json
@@ -34,11 +34,13 @@
     "astro": "^5.3.0",
     "axios": "^1.8.4",
     "better-sqlite3": "^11.9.1",
+    "chart.js": "^4.4.8",
     "class-variance-authority": "^0.7.0",
     "classnames": "^2.3.1",
     "dotenv": "^16.4.7",
     "jimp": "^0.22.8",
     "lucide-react": "^0.284.0",
+    "mqtt": "^5.10.4",
     "puppeteer": "^24.4.0",
     "react": "^18.2.0",
     "react-dom": "^18.2.0",
diff --git a/src/components/panels/ContentDetailPanel.jsx b/src/components/panels/ContentDetailPanel.jsx
index 8f9bf1f..28e5bb8 100644
--- a/src/components/panels/ContentDetailPanel.jsx
+++ b/src/components/panels/ContentDetailPanel.jsx
@@ -281,6 +281,20 @@ export default function ContentDetailPanel() {
       const formData = new FormData();
       const blob = new Blob([binaryData], {type: fileMetadata.type});
       
+      // For image types, create a preview data URL
+      let previewUrl = null;
+      if (fileMetadata.type.startsWith('image/')) {
+        try {
+          // Convert ArrayBuffer to base64 for preview
+          const array = new Uint8Array(binaryData);
+          const base64 = btoa(String.fromCharCode.apply(null, Array.from(array)));
+          previewUrl = `data:${fileMetadata.type};base64,${base64}`;
+          console.log("Created image preview URL for display");
+        } catch (error) {
+          console.error("Error creating image preview:", error);
+        }
+      }
+      
       formData.append('action', 'add');
       formData.append('file', blob, fileMetadata.name);
       formData.append('metadata', JSON.stringify({
@@ -302,17 +316,85 @@ export default function ContentDetailPanel() {
       
       // If successful, add reference to Redux so it shows in the UI
       if (result.success && result.hash) {
-        // Store reference with metadata for display
-        dispatch(addContent({
-          type: 'media',
-          fileName: fileMetadata.name,
-          mimeType: fileMetadata.type,
-          size: fileMetadata.size,
-          hash: result.hash,
-          contentReference: result.hash,
-          // Add preview URL for images
-          previewUrl: fileMetadata.previewUrl || null
-        }));
+        // For images and text files, we need to properly format the content
+        // to ensure it can be displayed correctly
+        let contentToStore;
+        
+        // For images, store as Buffer format with additional preview URL
+        if (fileMetadata.type.startsWith('image/')) {
+          // Store both the buffer data and a preview URL
+          contentToStore = {
+            type: 'media',
+            fileName: fileMetadata.name,
+            mimeType: fileMetadata.type,
+            size: fileMetadata.size,
+            hash: result.hash,
+            contentReference: result.hash,
+            // Convert ArrayBuffer to Buffer JSON format for consistent handling
+            content: {
+              type: 'Buffer',
+              data: Array.from(new Uint8Array(binaryData))
+            },
+            // Include preview URL for immediate display
+            previewUrl: previewUrl
+          };
+        } 
+        // For text files, decode and store as string
+        else if (fileMetadata.type === 'text/plain' || 
+                fileMetadata.type === 'text/markdown' ||
+                fileMetadata.type === 'application/json' ||
+                fileMetadata.type === 'text/csv') {
+          try {
+            const textContent = new TextDecoder().decode(new Uint8Array(binaryData));
+            contentToStore = {
+              type: 'media',
+              fileName: fileMetadata.name,
+              mimeType: fileMetadata.type,
+              size: fileMetadata.size,
+              hash: result.hash,
+              contentReference: result.hash,
+              // Store actual text content
+              content: textContent
+            };
+          } catch (error) {
+            console.error("Error decoding text content:", error);
+            contentToStore = {
+              type: 'media',
+              fileName: fileMetadata.name,
+              mimeType: fileMetadata.type,
+              size: fileMetadata.size,
+              hash: result.hash,
+              contentReference: result.hash,
+              // Fallback to Buffer format
+              content: {
+                type: 'Buffer',
+                data: Array.from(new Uint8Array(binaryData))
+              }
+            };
+          }
+        }
+        // For other binary formats
+        else {
+          contentToStore = {
+            type: 'media',
+            fileName: fileMetadata.name,
+            mimeType: fileMetadata.type,
+            size: fileMetadata.size,
+            hash: result.hash,
+            contentReference: result.hash,
+            // Store as Buffer JSON format
+            content: {
+              type: 'Buffer',
+              data: Array.from(new Uint8Array(binaryData))
+            }
+          };
+        }
+        
+        // Dispatch to Redux store
+        dispatch(addContent(contentToStore));
+        
+        console.log("Successfully saved content with hash:", result.hash);
+        console.log("Content type:", fileMetadata.type);
       }
     } catch (error) {
       console.error('Error saving binary content:', error);
diff --git a/src/components/panels/FileTablePanel.jsx b/src/components/panels/FileTablePanel.jsx
index 008e0df..0d5983c 100644
--- a/src/components/panels/FileTablePanel.jsx
+++ b/src/components/panels/FileTablePanel.jsx
@@ -80,6 +80,20 @@ const FileTablePanel = () => {
       };
     }
     
+    // Check for media type content with mimeType directly available
+    if (content && typeof content === 'object' && content.type === 'media' && content.mimeType) {
+      console.log("Detected type from media object:", content.mimeType);
+      const extension = content.mimeType.split('/')[1] || 'bin';
+      return {
+        mimeType: content.mimeType,
+        extension: extension,
+        isValid: true,
+        isBlob: false,
+        // For images, use the already created preview URL if available
+        previewUrl: content.previewUrl || null
+      };
+    }
+    
     // If we have Buffer JSON, convert it for checking
     let contentForDetection = content;
     let decodedText = null;
@@ -98,10 +112,25 @@ const FileTablePanel = () => {
         
         // If a specific type was detected, return it
         if (detectedType && detectedType.mimeType !== 'application/octet-stream') {
+          console.log("Detected specific type from buffer data:", detectedType.mimeType);
+          
+          // For images, create a preview URL
+          let previewUrl = null;
+          if (detectedType.mimeType.startsWith('image/')) {
+            try {
+              const base64 = btoa(String.fromCharCode.apply(null, array));
+              previewUrl = `data:${detectedType.mimeType};base64,${base64}`;
+              console.log("Created image preview URL from Buffer");
+            } catch (error) {
+              console.error("Error creating preview URL:", error);
+            }
+          }
+          
           return {
             ...detectedType,
             isValid: true,
             decodedText: decodedText,
+            previewUrl: previewUrl
           };
         }
         
diff --git a/src/components/panels/MQTTDashboardPanel.jsx b/src/components/panels/MQTTDashboardPanel.jsx
new file mode 100644
index 0000000..fa7e357
--- /dev/null
+++ b/src/components/panels/MQTTDashboardPanel.jsx
@@ -0,0 +1,273 @@
+'use client';
+
+import React, { useState, useEffect, useRef } from 'react';
+import { Chart, registerables } from 'chart.js';
+
+// Register Chart.js components
+Chart.register(...registerables);
+
+const MQTTDashboardPanel = () => {
+  // State hooks for all dashboard values
+  const [connectionStatus, setConnectionStatus] = useState('Connecting to MQTT Broker...');
+  const [currentTemp, setCurrentTemp] = useState('--');
+  const [voltage, setVoltage] = useState('--');
+  const [current, setCurrent] = useState('--');
+  const [power, setPower] = useState('--');
+  const [kwh, setKwh] = useState('--');
+  const [powerFactor, setPowerFactor] = useState('--');
+  const [customText, setCustomText] = useState('');
+  
+  // Reference for Chart.js
+  const chartRef = useRef(null);
+  const chartInstance = useRef(null);
+  
+  // MQTT client reference
+  const mqttClientRef = useRef(null);
+  
+  // Initialize MQTT and Chart.js
+  useEffect(() => {
+    // Import MQTT client dynamically to avoid SSR issues
+    const initializeMQTT = async () => {
+      try {
+        // Dynamically import MQTT to avoid SSR issues
+        const mqtt = await import('mqtt/dist/mqtt.min');
+        
+        // MQTT broker connection details
+        const broker = 'wss://1115a4b6fe5c40e588a3a85468f3c8be.s1.eu.hivemq.cloud:8884/mqtt';
+        const options = {
+          connectTimeout: 4000,
+          clientId: 'webClient_' + Math.random().toString(16).substr(2, 8),
+          username: 'testing',
+          password: 'Testing123',
+          clean: true,
+        };
+
+        // Connect to MQTT broker
+        console.log("Attempting to connect to MQTT broker...");
+        const client = mqtt.connect(broker, options);
+        mqttClientRef.current = client;
+
+        // Set up MQTT event handlers
+        client.on('connect', () => {
+          console.log("Connected to MQTT broker!");
+          setConnectionStatus('‚úÖ Connected to MQTT Broker');
+          
+          // Subscribe to topics
+          client.subscribe('sensor/temperature');
+          ['sensor/tegangan', 'sensor/arus', 'sensor/daya', 'sensor/kwh', 'sensor/pf'].forEach(topic => {
+            client.subscribe(topic);
+          });
+        });
+
+        client.on('error', (err) => {
+          console.error('MQTT Connection Error:', err);
+          setConnectionStatus('‚ùå MQTT Connection Error');
+        });
+
+        client.on('message', (topic, message) => {
+          const msg = message.toString();
+          const now = new Date().toLocaleTimeString();
+          console.log(`MQTT message received on topic ${topic}: ${msg}`);
+          
+          // Handle different topics
+          if (topic === 'sensor/temperature') {
+            const suhu = parseFloat(msg);
+            setCurrentTemp(suhu);
+            
+            // Update chart if it exists
+            if (chartInstance.current) {
+              const chart = chartInstance.current;
+              chart.data.labels.push(now);
+              chart.data.datasets[0].data.push(suhu);
+              
+              // Keep only last 20 data points
+              if (chart.data.labels.length > 20) {
+                chart.data.labels.shift();
+                chart.data.datasets[0].data.shift();
+              }
+              
+              chart.update();
+            }
+          }
+          
+          if (topic === 'sensor/tegangan') setVoltage(msg);
+          if (topic === 'sensor/arus') setCurrent(msg);
+          if (topic === 'sensor/daya') setPower(msg);
+          if (topic === 'sensor/kwh') setKwh(msg);
+          if (topic === 'sensor/pf') setPowerFactor(msg);
+        });
+      } catch (error) {
+        console.error("Error initializing MQTT:", error);
+        setConnectionStatus('‚ùå Failed to initialize MQTT client');
+      }
+    };
+
+    // Initialize the chart
+    if (chartRef.current) {
+      const ctx = chartRef.current.getContext('2d');
+      
+      // Create temperature chart
+      chartInstance.current = new Chart(ctx, {
+        type: 'line',
+        data: {
+          labels: [],
+          datasets: [{
+            label: 'Temperature (¬∞C)',
+            data: [],
+            fill: false,
+            borderColor: '#03dac5',
+            tension: 0.3
+          }]
+        },
+        options: {
+          responsive: true,
+          maintainAspectRatio: false,
+          scales: {
+            x: { 
+              title: { display: true, text: 'Waktu' },
+              grid: {
+                color: 'rgba(255, 255, 255, 0.1)'
+              },
+              ticks: {
+                color: '#e0e0e0'
+              }
+            },
+            y: { 
+              title: { display: true, text: 'Suhu (¬∞C)' }, 
+              suggestedMin: 20, 
+              suggestedMax: 40,
+              grid: {
+                color: 'rgba(255, 255, 255, 0.1)'
+              },
+              ticks: {
+                color: '#e0e0e0'
+              }
+            }
+          },
+          plugins: {
+            legend: {
+              labels: {
+                color: '#e0e0e0'
+              }
+            }
+          }
+        }
+      });
+    }
+    
+    // Initialize MQTT
+    initializeMQTT();
+
+    // Cleanup on unmount
+    return () => {
+      if (mqttClientRef.current) {
+        console.log("Disconnecting MQTT client...");
+        mqttClientRef.current.end();
+      }
+      if (chartInstance.current) {
+        chartInstance.current.destroy();
+      }
+    };
+  }, []);
+
+  // Functions to control the LED and send messages
+  const toggleLED = (state) => {
+    if (mqttClientRef.current) {
+      console.log(`Publishing LED state: ${state}`);
+      mqttClientRef.current.publish('control/led', state);
+    } else {
+      console.warn("MQTT client not initialized yet");
+    }
+  };
+
+  const sendText = () => {
+    if (mqttClientRef.current && customText.trim() !== '') {
+      console.log(`Publishing text: ${customText}`);
+      mqttClientRef.current.publish('control/tulisan', customText);
+      setCustomText('');
+    } else if (!mqttClientRef.current) {
+      console.warn("MQTT client not initialized yet");
+    }
+  };
+
+  // Handle enter key in the text input
+  const handleKeyPress = (e) => {
+    if (e.key === 'Enter') {
+      sendText();
+    }
+  };
+
+  return (
+    <div className="flex flex-col h-full overflow-auto bg-[#121212] text-[#e0e0e0] p-4">
+      <h2 className="text-center text-xl font-semibold text-[#03dac6] mb-4">MQTT Dashboard - Dark Mode</h2>
+      <p className="text-center italic mb-5">{connectionStatus}</p>
+      
+      {/* Temperature Chart */}
+      <div className="bg-[#1f1f1f] rounded-lg p-3 mb-5 h-64">
+        <canvas ref={chartRef} />
+      </div>
+      
+      <p className="text-center mb-4">Current Temperature: <span className="font-bold">{currentTemp}</span> ¬∞C</p>
+      
+      <h3 className="text-center text-lg font-semibold text-[#03dac6] mb-4">Data Energy Meter</h3>
+      
+      {/* Controls */}
+      <div className="flex flex-wrap justify-center gap-2 mb-6 items-center">
+        <button 
+          className="bg-[#00c853] hover:bg-[#00b248] text-white px-5 py-2 rounded-md transition-colors"
+          onClick={() => toggleLED('1')}
+        >
+          Nyalakan LED
+        </button>
+        <button 
+          className="bg-[#d50000] hover:bg-[#b71c1c] text-white px-5 py-2 rounded-md transition-colors"
+          onClick={() => toggleLED('0')}
+        >
+          Matikan LED
+        </button>
+        <input 
+          type="text" 
+          placeholder="Tulis pesan..." 
+          className="px-3 py-2 rounded-md bg-[#1e1e1e] text-white border-none flex-1 min-w-[150px]"
+          value={customText}
+          onChange={(e) => setCustomText(e.target.value)}
+          onKeyPress={handleKeyPress}
+        />
+        <button 
+          className="bg-[#2196f3] hover:bg-[#1976d2] text-white px-5 py-2 rounded-md transition-colors"
+          onClick={sendText}
+        >
+          Kirim
+        </button>
+      </div>
+      
+      {/* Energy Tiles */}
+      <div className="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4 mb-6">
+        <div className="bg-[#2196f3] p-4 rounded-lg shadow-lg text-center">
+          <h4 className="mb-2 font-medium">Tegangan</h4>
+          <div className="text-2xl font-bold">{voltage} V</div>
+        </div>
+        <div className="bg-[#4caf50] p-4 rounded-lg shadow-lg text-center">
+          <h4 className="mb-2 font-medium">Arus</h4>
+          <div className="text-2xl font-bold">{current} A</div>
+        </div>
+        <div className="bg-[#ffeb3b] p-4 rounded-lg shadow-lg text-center text-black">
+          <h4 className="mb-2 font-medium">Daya</h4>
+          <div className="text-2xl font-bold">{power} W</div>
+        </div>
+        <div className="bg-[#ff9800] p-4 rounded-lg shadow-lg text-center">
+          <h4 className="mb-2 font-medium">KWH</h4>
+          <div className="text-2xl font-bold">{kwh} kWh</div>
+        </div>
+        <div className="bg-[#9c27b0] p-4 rounded-lg shadow-lg text-center">
+          <h4 className="mb-2 font-medium">Power Factor</h4>
+          <div className="text-2xl font-bold">{powerFactor}</div>
+        </div>
+      </div>
+      
+      <h3 className="text-center text-lg font-semibold text-[#03dac6] mb-4">Kirim Pesan Manual</h3>
+    </div>
+  );
+};
+
+export default MQTTDashboardPanel;
diff --git a/src/components/panels/Sidebar.astro b/src/components/panels/Sidebar.astro
index 62d9aee..6ee08fa 100644
--- a/src/components/panels/Sidebar.astro
+++ b/src/components/panels/Sidebar.astro
@@ -50,6 +50,21 @@ const { class: className, ...props } = Astro.props;
           File Table
         </span>
       </button>
+      <button
+        id="mqttDashboardLayoutBtn"
+        title="MQTT Dashboard"
+        class="flex items-center justify-center w-12 h-12 hover:bg-muted-foreground/10 transition-colors group relative"
+      >
+        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
+          <rect x="2" y="3" width="20" height="14" rx="2" ry="2"></rect>
+          <line x1="8" y1="21" x2="16" y2="21"></line>
+          <line x1="12" y1="17" x2="12" y2="21"></line>
+          <path d="M6 8h.01M9 8h.01M12 8h.01M15 8h.01M18 8h.01M6 12h.01M9 12h.01M12 12h.01M15 12h.01M18 12h.01"></path>
+        </svg>
+        <span class="absolute left-full ml-2 bg-neutral-700 text-white text-xs px-2 py-1 rounded opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none">
+          MQTT Dashboard
+        </span>
+      </button>
     </div>
     <div>
       <div class="flex items-center justify-center w-12 h-12 hover:bg-muted-foreground/10 transition-colors">
@@ -68,6 +83,7 @@ const { class: className, ...props } = Astro.props;
   const generateLayoutBtn = document.getElementById('generateLayoutBtn');
   const clmLayoutBtn = document.getElementById('clmLayoutBtn');
   const fileLayoutBtn = document.getElementById('fileLayoutBtn');
+  const mqttDashboardLayoutBtn = document.getElementById('mqttDashboardLayoutBtn');
 
   // Add click handlers
   todoLayoutBtn?.addEventListener('click', () => {
@@ -86,6 +102,10 @@ const { class: className, ...props } = Astro.props;
     store.dispatch(changeLayout('file_table_layout'));
   });
 
+  mqttDashboardLayoutBtn?.addEventListener('click', () => {
+    store.dispatch(changeLayout('mqtt_dashboard_layout'));
+  });
+
   // Function to update active button styles
   function updateActiveButton(layout: string) {
     // Remove active styles from all buttons
@@ -93,12 +113,14 @@ const { class: className, ...props } = Astro.props;
     generateLayoutBtn?.classList.remove('border-l-2', 'border-primary', 'bg-muted');
     clmLayoutBtn?.classList.remove('border-l-2', 'border-primary', 'bg-muted');
     fileLayoutBtn?.classList.remove('border-l-2', 'border-primary', 'bg-muted');
+    mqttDashboardLayoutBtn?.classList.remove('border-l-2', 'border-primary', 'bg-muted');
 
     // Reset icon colors
     todoLayoutBtn?.querySelector('.text-primary')?.classList.replace('text-primary', 'text-muted-foreground');
     generateLayoutBtn?.querySelector('.text-primary')?.classList.replace('text-primary', 'text-muted-foreground');
     clmLayoutBtn?.querySelector('.text-primary')?.classList.replace('text-primary', 'text-muted-foreground');
     fileLayoutBtn?.querySelector('.text-primary')?.classList.replace('text-primary', 'text-muted-foreground');
+    mqttDashboardLayoutBtn?.querySelector('.text-primary')?.classList.replace('text-primary', 'text-muted-foreground');
 
     // Add active styles to the selected button
     if (layout === 'todo_layout') {
@@ -113,6 +135,9 @@ const { class: className, ...props } = Astro.props;
     } else if (layout === 'file_table_layout') {
       fileLayoutBtn?.classList.add('border-l-2', 'border-primary', 'bg-muted');
       fileLayoutBtn?.querySelector('.text-muted-foreground')?.classList.replace('text-muted-foreground', 'text-primary');
+    } else if (layout === 'mqtt_dashboard_layout') {
+      mqttDashboardLayoutBtn?.classList.add('border-l-2', 'border-primary', 'bg-muted');
+      mqttDashboardLayoutBtn?.querySelector('.text-muted-foreground')?.classList.replace('text-muted-foreground', 'text-primary');
     }
   }
 
@@ -122,6 +147,7 @@ const { class: className, ...props } = Astro.props;
     if (panels.right.type === 'GeneratePanel') return 'generate_layout';
     if (panels.right.type === 'CLMInputPanel') return 'clm_layout';
     if (panels.middle?.type === 'CLMInputPanel' && panels.right?.type === 'ContentDetailPanel') return 'file_table_layout';
+    if (panels.right.type === 'MQTTDashboardPanel') return 'mqtt_dashboard_layout';
     return 'todo_layout';
   };
 
diff --git a/src/components/panels/SimpleMQTTDashboardPanel.jsx b/src/components/panels/SimpleMQTTDashboardPanel.jsx
new file mode 100644
index 0000000..65e6f81
--- /dev/null
+++ b/src/components/panels/SimpleMQTTDashboardPanel.jsx
@@ -0,0 +1,297 @@
+'use client';
+
+import React, { useState, useEffect, useRef } from 'react';
+
+/**
+ * Simple MQTT Dashboard Panel that uses the browser's window object to load MQTT
+ * and avoids issues with server-side rendering
+ */
+const SimpleMQTTDashboardPanel = () => {
+  // State hooks for all dashboard values
+  const [connectionStatus, setConnectionStatus] = useState('Waiting for MQTT library...');
+  const [currentTemp, setCurrentTemp] = useState('--');
+  const [voltage, setVoltage] = useState('--');
+  const [current, setCurrent] = useState('--');
+  const [power, setPower] = useState('--');
+  const [kwh, setKwh] = useState('--');
+  const [powerFactor, setPowerFactor] = useState('--');
+  const [customText, setCustomText] = useState('');
+  
+  // References for Chart.js canvas and MQTT client
+  const chartCanvasRef = useRef(null);
+  const mqttClientRef = useRef(null);
+  const chartInstanceRef = useRef(null);
+  
+  // Utility function to load external scripts
+  const loadScript = (src) => {
+    return new Promise((resolve, reject) => {
+      const script = document.createElement('script');
+      script.src = src;
+      script.async = true;
+      script.onload = () => resolve();
+      script.onerror = () => reject(new Error(`Failed to load script: ${src}`));
+      document.head.appendChild(script);
+    });
+  };
+  
+  // Initialize everything
+  useEffect(() => {
+    let mqttClient = null;
+    let chartInstance = null;
+    const tempData = {
+      labels: [],
+      datasets: [{
+        label: 'Temperature (¬∞C)',
+        data: [],
+        fill: false,
+        borderColor: '#03dac5',
+        tension: 0.3
+      }]
+    };
+    
+    const initializeDashboard = async () => {
+      try {
+        // Load required scripts
+        setConnectionStatus('Loading required libraries...');
+        await Promise.all([
+          loadScript('https://unpkg.com/mqtt/dist/mqtt.min.js'),
+          loadScript('https://cdn.jsdelivr.net/npm/chart.js')
+        ]);
+        setConnectionStatus('Libraries loaded, connecting to broker...');
+        
+        // Connect to MQTT broker when scripts are loaded
+        if (window.mqtt) {
+          const broker = 'wss://1115a4b6fe5c40e588a3a85468f3c8be.s1.eu.hivemq.cloud:8884/mqtt';
+          const options = {
+            connectTimeout: 4000,
+            clientId: 'webClient_' + Math.random().toString(16).substr(2, 8),
+            username: 'testing',
+            password: 'Testing123',
+            clean: true,
+          };
+          
+          console.log("Attempting to connect to MQTT broker...");
+          mqttClient = window.mqtt.connect(broker, options);
+          mqttClientRef.current = mqttClient;
+          
+          mqttClient.on('connect', () => {
+            console.log("Connected to MQTT broker!");
+            setConnectionStatus('‚úÖ Connected to MQTT Broker');
+            
+            // Subscribe to topics
+            mqttClient.subscribe('sensor/temperature');
+            [
+              'sensor/tegangan', 
+              'sensor/arus', 
+              'sensor/daya', 
+              'sensor/kwh', 
+              'sensor/pf'
+            ].forEach(topic => {
+              mqttClient.subscribe(topic);
+            });
+          });
+          
+          mqttClient.on('error', (err) => {
+            console.error('MQTT Connection Error:', err);
+            setConnectionStatus('‚ùå MQTT Connection Error: ' + err.message);
+          });
+          
+          mqttClient.on('message', (topic, message) => {
+            const msg = message.toString();
+            const now = new Date().toLocaleTimeString();
+            console.log(`MQTT message received on topic ${topic}: ${msg}`);
+            
+            // Handle different topics
+            if (topic === 'sensor/temperature') {
+              const suhu = parseFloat(msg);
+              setCurrentTemp(suhu);
+              
+              // Update chart
+              if (chartInstanceRef.current) {
+                tempData.labels.push(now);
+                tempData.datasets[0].data.push(suhu);
+                
+                // Keep only last 20 data points
+                if (tempData.labels.length > 20) {
+                  tempData.labels.shift();
+                  tempData.datasets[0].data.shift();
+                }
+                
+                chartInstanceRef.current.update();
+              }
+            }
+            
+            if (topic === 'sensor/tegangan') setVoltage(msg);
+            if (topic === 'sensor/arus') setCurrent(msg);
+            if (topic === 'sensor/daya') setPower(msg);
+            if (topic === 'sensor/kwh') setKwh(msg);
+            if (topic === 'sensor/pf') setPowerFactor(msg);
+          });
+        } else {
+          setConnectionStatus('‚ùå MQTT library not found');
+          console.error('MQTT library not loaded properly');
+        }
+        
+        // Initialize Chart.js
+        if (window.Chart && chartCanvasRef.current) {
+          const ctx = chartCanvasRef.current.getContext('2d');
+          
+          chartInstance = new window.Chart(ctx, {
+            type: 'line',
+            data: tempData,
+            options: {
+              responsive: true,
+              maintainAspectRatio: false,
+              scales: {
+                x: { 
+                  title: { display: true, text: 'Waktu' },
+                  grid: { color: 'rgba(255, 255, 255, 0.1)' },
+                  ticks: { color: '#e0e0e0' }
+                },
+                y: { 
+                  title: { display: true, text: 'Suhu (¬∞C)' }, 
+                  suggestedMin: 20, 
+                  suggestedMax: 40,
+                  grid: { color: 'rgba(255, 255, 255, 0.1)' },
+                  ticks: { color: '#e0e0e0' }
+                }
+              },
+              plugins: {
+                legend: {
+                  labels: { color: '#e0e0e0' }
+                }
+              }
+            }
+          });
+          chartInstanceRef.current = chartInstance;
+        } else {
+          console.error('Chart.js library not loaded properly or canvas not found');
+        }
+      } catch (error) {
+        console.error('Error initializing dashboard:', error);
+        setConnectionStatus('‚ùå Error initializing dashboard: ' + error.message);
+      }
+    };
+    
+    // Only run in browser environment
+    if (typeof window !== 'undefined') {
+      initializeDashboard();
+    }
+    
+    // Cleanup on unmount
+    return () => {
+      if (mqttClientRef.current) {
+        console.log('Disconnecting MQTT client...');
+        mqttClientRef.current.end();
+      }
+      if (chartInstanceRef.current) {
+        chartInstanceRef.current.destroy();
+      }
+    };
+  }, []);
+  
+  // MQTT control functions
+  const toggleLED = (state) => {
+    if (mqttClientRef.current) {
+      console.log(`Publishing LED state: ${state}`);
+      mqttClientRef.current.publish('control/led', state);
+    } else {
+      console.warn('MQTT client not initialized yet');
+      setConnectionStatus('‚ö†Ô∏è MQTT client not ready, try again in a moment');
+    }
+  };
+  
+  const sendText = () => {
+    if (mqttClientRef.current && customText.trim() !== '') {
+      console.log(`Publishing text: ${customText}`);
+      mqttClientRef.current.publish('control/tulisan', customText);
+      setCustomText('');
+    } else if (!mqttClientRef.current) {
+      console.warn('MQTT client not initialized yet');
+      setConnectionStatus('‚ö†Ô∏è MQTT client not ready, try again in a moment');
+    }
+  };
+  
+  const handleKeyPress = (e) => {
+    if (e.key === 'Enter') {
+      sendText();
+    }
+  };
+  
+  // UI rendering
+  return (
+    <div className="flex flex-col h-full overflow-auto bg-[#121212] text-[#e0e0e0] p-4">
+      <h2 className="text-center text-xl font-semibold text-[#03dac6] mb-4">MQTT Dashboard - Dark Mode</h2>
+      <p className="text-center italic mb-5">{connectionStatus}</p>
+      
+      {/* Temperature Chart */}
+      <div className="bg-[#1f1f1f] rounded-lg p-3 mb-5 h-64">
+        <canvas ref={chartCanvasRef} />
+      </div>
+      
+      <p className="text-center mb-4">
+        Current Temperature: <span className="font-bold">{currentTemp}</span> ¬∞C
+      </p>
+      
+      <h3 className="text-center text-lg font-semibold text-[#03dac6] mb-4">Data Energy Meter</h3>
+      
+      {/* Controls */}
+      <div className="flex flex-wrap justify-center gap-2 mb-6 items-center">
+        <button 
+          className="bg-[#00c853] hover:bg-[#00b248] text-white px-5 py-2 rounded-md transition-colors"
+          onClick={() => toggleLED('1')}
+        >
+          Nyalakan LED
+        </button>
+        <button 
+          className="bg-[#d50000] hover:bg-[#b71c1c] text-white px-5 py-2 rounded-md transition-colors"
+          onClick={() => toggleLED('0')}
+        >
+          Matikan LED
+        </button>
+        <input 
+          type="text" 
+          placeholder="Tulis pesan..." 
+          className="px-3 py-2 rounded-md bg-[#1e1e1e] text-white border-none flex-1 min-w-[150px]"
+          value={customText}
+          onChange={(e) => setCustomText(e.target.value)}
+          onKeyPress={handleKeyPress}
+        />
+        <button 
+          className="bg-[#2196f3] hover:bg-[#1976d2] text-white px-5 py-2 rounded-md transition-colors"
+          onClick={sendText}
+        >
+          Kirim
+        </button>
+      </div>
+      
+      {/* Energy Tiles */}
+      <div className="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4 mb-6">
+        <div className="bg-[#2196f3] p-4 rounded-lg shadow-lg text-center">
+          <h4 className="mb-2 font-medium">Tegangan</h4>
+          <div className="text-2xl font-bold">{voltage} V</div>
+        </div>
+        <div className="bg-[#4caf50] p-4 rounded-lg shadow-lg text-center">
+          <h4 className="mb-2 font-medium">Arus</h4>
+          <div className="text-2xl font-bold">{current} A</div>
+        </div>
+        <div className="bg-[#ffeb3b] p-4 rounded-lg shadow-lg text-center text-black">
+          <h4 className="mb-2 font-medium">Daya</h4>
+          <div className="text-2xl font-bold">{power} W</div>
+        </div>
+        <div className="bg-[#ff9800] p-4 rounded-lg shadow-lg text-center">
+          <h4 className="mb-2 font-medium">KWH</h4>
+          <div className="text-2xl font-bold">{kwh} kWh</div>
+        </div>
+        <div className="bg-[#9c27b0] p-4 rounded-lg shadow-lg text-center">
+          <h4 className="mb-2 font-medium">Power Factor</h4>
+          <div className="text-2xl font-bold">{powerFactor}</div>
+        </div>
+      </div>
+      
+      <h3 className="text-center text-lg font-semibold text-[#03dac6] mb-4">Kirim Pesan Manual</h3>
+    </div>
+  );
+};
+
+export default SimpleMQTTDashboardPanel;
diff --git a/src/components/panels/panels.json b/src/components/panels/panels.json
index 5a1b042..8b256e8 100644
--- a/src/components/panels/panels.json
+++ b/src/components/panels/panels.json
@@ -43,5 +43,8 @@
   },
   "ContentViewerPanel": {
     "component": "../components/panels/ContentViewerPanel.jsx"
+  },
+  "MQTTDashboardPanel": {
+    "component": "../components/panels/MQTTDashboardPanel.jsx"
   }
 }
diff --git a/src/features/panellayoutSlice.json b/src/features/panellayoutSlice.json
index a9e2573..084e841 100644
--- a/src/features/panellayoutSlice.json
+++ b/src/features/panellayoutSlice.json
@@ -78,6 +78,25 @@
             "minSize": 30,
             "visible": true
         }
+    },
+    "mqtt_dashboard_layout": {
+        "left": {
+            "type": "FileTablePanel",
+            "size": 0,
+            "minSize": 0,
+            "visible": false
+        },
+        "middle": {
+            "type": "SimpleMQTTDashboardPanel", 
+            "size": 100,
+            "minSize": 100,
+            "visible": true
+        },
+        "right": {
+            "type": "ContentDetailPanel",
+            "size": 0,
+            "minSize": 0,
+            "visible": false
+        }
     }
-    
 }

commit 4f158f4c4b2844330585f8fd23639dfd9aacb862
Author: Henry Koo <lckoo1230@gmail.com>
Date:   Wed Apr 2 10:43:42 2025 +0800

    new file displayer

diff --git a/src/components/panels/ContentDetailPanel.jsx b/src/components/panels/ContentDetailPanel.jsx
index bef5af1..8f9bf1f 100644
--- a/src/components/panels/ContentDetailPanel.jsx
+++ b/src/components/panels/ContentDetailPanel.jsx
@@ -8,6 +8,8 @@ import {
 } from '../../features/contentSlice.js';
 import ContentEditor from '../ui/ContentEditor';
 import FileUploader from '../ui/FileUploader';
+import { FileTypeIcon } from '../ui/icons/FileTypeIcon';
+import TXTViewer from '../viewers/TXTViewer';
 
 export default function ContentDetailPanel() {
   const [isEditing, setIsEditing] = useState(false);
@@ -22,6 +24,10 @@ export default function ContentDetailPanel() {
   const selectedHash = useSelector(state => state?.content?.selectedHash);
   const cardsMap = useSelector(state => state?.content?.cards || {});
   
+  // Additional selector for content type from the selected item slice
+  const selectedItemMetadata = useSelector(state => state?.selectedItem?.metadata);
+  const selectedItemContent = useSelector(state => state?.selectedItem?.content);
+  
   // Memoize the calculated values, not the selector itself
   const selectedContentItem = useMemo(() => {
     // Find the card by hash - safely handle when cards is undefined or empty
@@ -32,6 +38,28 @@ export default function ContentDetailPanel() {
     return null;
   }, [cardsMap, selectedHash]);
 
+  // Helper function to determine content type
+  const getContentType = useMemo(() => {
+    // First check if we have content type in selectedItemMetadata
+    if (selectedItemMetadata && selectedItemMetadata.contentType && 
+        selectedItemMetadata.contentType !== "null") {
+      return selectedItemMetadata.contentType;
+    }
+    
+    // Then check the card's content type if available
+    if (selectedContentItem?.contentType?.mimeType) {
+      return selectedContentItem.contentType.mimeType;
+    }
+    
+    // Fallback: try to detect from content object properties
+    if (selectedContentItem?.content?.mimeType) {
+      return selectedContentItem.content.mimeType;
+    }
+    
+    // Ultimate fallback
+    return 'text/plain';
+  }, [selectedItemMetadata, selectedContentItem]);
+
   // Helper function to handle different content types
   const formatContent = (content) => {
     if (!content) return '';
@@ -39,6 +67,23 @@ export default function ContentDetailPanel() {
     // If content is already a string, return it
     if (typeof content === 'string') return content;
     
+    // Special handling for Buffer JSON that contains text
+    if (typeof content === 'object' && content?.type === 'Buffer' && Array.isArray(content?.data)) {
+      try {
+        // Convert to Uint8Array and decode as text - this handles the case where text files
+        // are stored as Buffer JSON but should be displayed as text (for txt, md, etc.)
+        const array = new Uint8Array(content.data);
+        const text = new TextDecoder().decode(array);
+        
+        // Log the conversion for debugging
+        console.log("ContentDetailPanel: Converted Buffer JSON to text", text.substring(0, 30) + "...");
+        
+        return text;
+      } catch (e) {
+        console.error("ContentDetailPanel: Error decoding Buffer content", e);
+      }
+    }
+    
     // If it's an object (parsed JSON), stringify it for display
     if (typeof content === 'object') {
       try {
@@ -415,74 +460,174 @@ export default function ContentDetailPanel() {
           </div>
         )}
         
-        {/* Media Preview */}
+        {/* Media Preview - Using Card Layout */}
         {isMediaPreview && (
-          <div className="w-full flex flex-col items-center justify-center p-4 bg-gray-50 dark:bg-gray-800 rounded-lg mb-3">
-            {/* Display based on media type */}
-            {fileInfo?.type?.startsWith('image/') || selectedContentItem?.content?.mimeType?.startsWith('image/') ? (
-              <img 
-                src={fileInfo?.previewUrl || fileInfo?.data || selectedContentItem?.content?.previewUrl || selectedContentItem?.content?.data} 
-                alt={fileInfo?.name || selectedContentItem?.content?.fileName || "Image preview"}
-                className="max-w-full max-h-[400px] object-contain mb-2"
-              />
-            ) : fileInfo?.type?.startsWith('video/') || selectedContentItem?.content?.mimeType?.startsWith('video/') ? (
-              <video 
-                controls
-                src={fileInfo?.previewUrl || fileInfo?.data || selectedContentItem?.content?.previewUrl || selectedContentItem?.content?.data}
-                className="max-w-full max-h-[400px] mb-2"
-              >
-                Your browser does not support the video tag.
-              </video>
-            ) : fileInfo?.type?.startsWith('audio/') || selectedContentItem?.content?.mimeType?.startsWith('audio/') ? (
-              <audio 
-                controls
-                src={fileInfo?.previewUrl || fileInfo?.data || selectedContentItem?.content?.previewUrl || selectedContentItem?.content?.data}
-                className="w-full mb-2"
-              >
-                Your browser does not support the audio tag.
-              </audio>
-            ) : fileInfo?.type === 'application/pdf' || selectedContentItem?.content?.mimeType === 'application/pdf' ? (
-              <div className="w-full text-center">
-                <div className="text-4xl mb-2">üìÑ</div>
-                <p>PDF file: {fileInfo?.name || selectedContentItem?.content?.fileName}</p>
-                <a 
-                  href={fileInfo?.previewUrl || fileInfo?.data || selectedContentItem?.content?.previewUrl || selectedContentItem?.content?.data} 
-                  target="_blank" 
-                  rel="noopener noreferrer"
-                  className="text-blue-500 underline mt-2 inline-block"
-                >
-                  Open PDF
-                </a>
+          <div className="w-full bg-white dark:bg-gray-800 rounded-lg shadow-md overflow-hidden">
+            <div className="p-4 flex flex-col items-center">
+              {/* File Type Icon */}
+              <div className="mb-4">
+                <FileTypeIcon 
+                  mimeType={fileInfo?.type || selectedContentItem?.content?.mimeType} 
+                  extension={getFileExtension(fileInfo?.name || selectedContentItem?.content?.fileName)}
+                  size={48}
+                />
               </div>
-            ) : (
-              <div className="text-center">
-                <div className="text-4xl mb-2">üìÅ</div>
-                <p>File: {fileInfo?.name || selectedContentItem?.content?.fileName}</p>
-                <p className="text-sm text-gray-500">
-                  {fileInfo?.type || selectedContentItem?.content?.mimeType || "Unknown file type"}
-                </p>
+              
+              {/* File Name */}
+              <h3 className="text-lg font-semibold text-center mb-2">
+                {fileInfo?.name || selectedContentItem?.content?.fileName || "File"}
+              </h3>
+              
+              {/* File Info */}
+              <div className="text-sm text-gray-500 mb-4">
+                {fileInfo?.type || selectedContentItem?.content?.mimeType || "Unknown type"} ‚Ä¢ 
+                {formatFileSize(fileInfo?.size || selectedContentItem?.content?.size || 0)}
+              </div>
+
+              {/* Media Preview Based on Type */}
+              <div className="w-full flex justify-center mb-4">
+                {fileInfo?.type?.startsWith('image/') || selectedContentItem?.content?.mimeType?.startsWith('image/') ? (
+                  <img 
+                    src={fileInfo?.previewUrl || fileInfo?.data || selectedContentItem?.content?.previewUrl || selectedContentItem?.content?.data} 
+                    alt={fileInfo?.name || selectedContentItem?.content?.fileName || "Image preview"}
+                    className="max-w-full max-h-[300px] object-contain rounded-md"
+                  />
+                ) : fileInfo?.type?.startsWith('video/') || selectedContentItem?.content?.mimeType?.startsWith('video/') ? (
+                  <video 
+                    controls
+                    src={fileInfo?.previewUrl || fileInfo?.data || selectedContentItem?.content?.previewUrl || selectedContentItem?.content?.data}
+                    className="max-w-full max-h-[300px] rounded-md"
+                  >
+                    Your browser does not support the video tag.
+                  </video>
+                ) : fileInfo?.type?.startsWith('audio/') || selectedContentItem?.content?.mimeType?.startsWith('audio/') ? (
+                  <audio 
+                    controls
+                    src={fileInfo?.previewUrl || fileInfo?.data || selectedContentItem?.content?.previewUrl || selectedContentItem?.content?.data}
+                    className="w-full rounded-md"
+                  >
+                    Your browser does not support the audio tag.
+                  </audio>
+                ) : fileInfo?.type === 'application/pdf' || selectedContentItem?.content?.mimeType === 'application/pdf' ? (
+                  <div className="text-center p-6 bg-gray-50 dark:bg-gray-700 rounded-lg">
+                    <div className="text-6xl mb-3">
+                      <FileTypeIcon mimeType="application/pdf" size={64} />
+                    </div>
+                    <a 
+                      href={fileInfo?.previewUrl || fileInfo?.data || selectedContentItem?.content?.previewUrl || selectedContentItem?.content?.data} 
+                      target="_blank" 
+                      rel="noopener noreferrer"
+                      className="text-blue-500 hover:text-blue-700 underline mt-2 inline-block"
+                    >
+                      Open PDF
+                    </a>
+                  </div>
+                ) : (
+                  <div className="text-center p-6 bg-gray-50 dark:bg-gray-700 rounded-lg">
+                    <FileTypeIcon 
+                      mimeType={fileInfo?.type || selectedContentItem?.content?.mimeType}
+                      extension={getFileExtension(fileInfo?.name || selectedContentItem?.content?.fileName)}
+                      size={64}
+                    />
+                  </div>
+                )}
               </div>
-            )}
-            <div className="text-sm text-gray-500 mt-2">
-              Size: {formatFileSize(fileInfo?.size || selectedContentItem?.content?.size || 0)}
             </div>
           </div>
         )}
         
-        {/* Text Editor (Hidden for media when not editing) */}
-        <div className={`w-full h-full max-w-full ${isMediaPreview && !isEditing ? 'hidden' : ''}`}>
-          <ContentEditor
-            content={editorContent || ''}
-            onChange={handleContentChange}
-            onSave={isEditing ? handleSubmit : undefined}
-            title={isEditing ? 'Edit Content' : 'Content Viewer'}
-            isReadOnly={!isEditing}
-            showLineNumbers={true}
-            language="Plain Text"
-            className="w-full h-full"
-          />
-        </div>
+        {/* Text Content Card View */}
+        {!isMediaPreview && selectedContentItem && !isEditing && (
+          <div className="w-full bg-white dark:bg-gray-800 rounded-lg shadow-md overflow-hidden">
+            <div className="border-b border-gray-200 dark:border-gray-700 p-4">
+              <div className="flex items-center">
+                <FileTypeIcon 
+                  mimeType={getContentType()}
+                  size={24}
+                  className="mr-3"
+                />
+                <div>
+                  <h3 className="font-medium">
+                    {selectedHash ? `${selectedHash.substring(0, 8)}...` : 'Text Content'}
+                  </h3>
+                  <p className="text-xs text-gray-500">
+                    {getContentType()}
+                  </p>
+                </div>
+              </div>
+            </div>
+            
+            <div className="p-0">
+              {/* Use TXTViewer for text/plain files */}
+              {getContentType() === 'text/plain' ? (
+                <TXTViewer content={selectedContentItem?.content} />
+              ) : (
+                <ContentEditor
+                  content={editorContent || ''}
+                  onChange={handleContentChange}
+                  title={'Content Viewer'}
+                  isReadOnly={true}
+                  showLineNumbers={true}
+                  language="Plain Text"
+                  className="w-full border-0 rounded-none"
+                />
+              )}
+            </div>
+          </div>
+        )}
+        
+        {/* Text Editor Interface - When Editing */}
+        {isEditing && (
+          <div className="w-full bg-white dark:bg-gray-800 rounded-lg shadow-md overflow-hidden">
+            <div className="border-b border-gray-200 dark:border-gray-700 p-4">
+              <div className="flex items-center">
+                <FileTypeIcon 
+                  mimeType={getContentType()}
+                  extension={fileInfo?.name ? getFileExtension(fileInfo.name) : undefined}
+                  size={24}
+                  className="mr-3"
+                />
+                <h3 className="font-medium">Edit Content</h3>
+              </div>
+            </div>
+            
+            <div className="p-0">
+              <ContentEditor
+                content={editorContent || ''}
+                onChange={handleContentChange}
+                onSave={handleSubmit}
+                title={'Edit Content'}
+                isReadOnly={false}
+                showLineNumbers={true}
+                language="Plain Text"
+                className="w-full border-0 rounded-none"
+              />
+            </div>
+          </div>
+        )}
+        
+        {/* Empty State */}
+        {!isEditing && !selectedContentItem && !isMediaPreview && (
+          <div className="w-full h-full flex flex-col items-center justify-center text-gray-500">
+            <FileTypeIcon size={64} className="mb-4 opacity-50" />
+            <p className="text-lg font-medium">No Content Selected</p>
+            <p className="text-sm mt-2">Select an item from the list or create new content</p>
+            <button
+              onClick={handleNewClick}
+              className="mt-6 px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 transition-colors"
+            >
+              Create New Content
+            </button>
+          </div>
+        )}
       </div>
     </div>
   );
-}
\ No newline at end of file
+}
+
+// Helper function to get file extension from a filename
+const getFileExtension = (filename) => {
+  if (!filename) return '';
+  const parts = filename.split('.');
+  return parts.length > 1 ? parts[parts.length - 1].toLowerCase() : '';
+};
\ No newline at end of file
diff --git a/src/components/panels/FileTablePanel.jsx b/src/components/panels/FileTablePanel.jsx
new file mode 100644
index 0000000..008e0df
--- /dev/null
+++ b/src/components/panels/FileTablePanel.jsx
@@ -0,0 +1,349 @@
+'use client';
+
+import React, { useState, useEffect } from 'react';
+import { useDispatch, useSelector } from 'react-redux';
+import { FileTypeIcon } from '../ui/icons/FileTypeIcon';
+import { ContentTypeInterpreter } from '../../content/model/content_type_detector';
+import { selectItem, updateContentType } from '../../features/selectedItemSlice';
+
+const FileTablePanel = () => {
+  const [searchQuery, setSearchQuery] = useState('');
+  const [loading, setLoading] = useState(false);
+  const [retrievedCards, setRetrievedCards] = useState([]);
+  const [totalCount, setTotalCount] = useState(0);
+  const [sortConfig, setSortConfig] = useState({ key: 'g_time', direction: 'desc' });
+  
+  const selectedHash = useSelector(state => state?.selectedItem?.metadata?.hash || 'null');
+  const dispatch = useDispatch();
+
+  // Fetch cards on mount and when search query changes
+  useEffect(() => {
+    fetchCards();
+  }, [searchQuery]);
+
+  const fetchCards = async () => {
+    setLoading(true);
+    try {
+      const queryParams = new URLSearchParams();
+      if (searchQuery) {
+        queryParams.append('query', searchQuery);
+      }
+      
+      const response = await fetch(`/api/retrieve?${queryParams.toString()}`);
+      if (!response.ok) {
+        throw new Error(`API error: ${response.status}`);
+      }
+      
+      const data = await response.json();
+      
+      // Process retrieved cards to detect content types
+      const processedCards = await Promise.all(data.items.map(async (card) => {
+        // Skip processing if the card already has a well-detected content type
+        if (card.contentType && card.contentType.isValid) {
+          return card;
+        }
+        
+        try {
+          // Apply content type detection
+          const contentType = await detectContentType(card.content);
+          return {
+            ...card,
+            contentType: {
+              ...contentType,
+              detectionMethod: 'client-table',
+            }
+          };
+        } catch (error) {
+          console.error("Error detecting content type:", error);
+          return card;
+        }
+      }));
+      
+      setRetrievedCards(processedCards);
+      setTotalCount(data.total_items || processedCards.length);
+    } catch (error) {
+      console.error("Error fetching cards:", error);
+    } finally {
+      setLoading(false);
+    }
+  };
+
+  // Function to detect content type from content data
+  const detectContentType = async (content) => {
+    // If content is null or undefined
+    if (!content) {
+      return { 
+        mimeType: 'application/octet-stream', 
+        extension: 'bin',
+        isValid: false,
+        isBlob: false,
+      };
+    }
+    
+    // If we have Buffer JSON, convert it for checking
+    let contentForDetection = content;
+    let decodedText = null;
+    
+    if (content && typeof content === 'object' && content.type === 'Buffer' && Array.isArray(content.data)) {
+      try {
+        // Convert to Uint8Array for content-based detection
+        const array = new Uint8Array(content.data);
+        
+        // Also try to decode as text to check for textual content
+        decodedText = new TextDecoder().decode(array);
+        
+        // Create a ContentTypeInterpreter instance for detection
+        const interpreter = new ContentTypeInterpreter();
+        const detectedType = interpreter.detectContentType(array);
+        
+        // If a specific type was detected, return it
+        if (detectedType && detectedType.mimeType !== 'application/octet-stream') {
+          return {
+            ...detectedType,
+            isValid: true,
+            decodedText: decodedText,
+          };
+        }
+        
+        // Text detection based on character analysis
+        const printableChars = decodedText.match(/[\x20-\x7E\n\r\t]/g) || [];
+        const ratio = printableChars.length / decodedText.length;
+        
+        // If high ratio of printable characters, it's likely text
+        if (decodedText.length > 0 && ratio > 0.8) {
+          console.log("High printable character ratio:", ratio.toFixed(2));
+          return {
+            mimeType: 'text/plain',
+            extension: 'txt',
+            isValid: true,
+            decodedText: decodedText,
+          };
+        }
+        
+        // Return binary type as fallback
+        return {
+          mimeType: 'application/octet-stream',
+          extension: 'bin',
+          isValid: true,
+          isBlob: true,
+        };
+      } catch (error) {
+        console.error("Error processing Buffer data:", error);
+      }
+    }
+    
+    // String content is treated as text
+    if (typeof content === 'string') {
+      // Check for JSON format
+      try {
+        JSON.parse(content);
+        return {
+          mimeType: 'application/json',
+          extension: 'json',
+          isValid: true,
+        };
+      } catch {
+        // Not JSON, treat as plain text
+        return {
+          mimeType: 'text/plain',
+          extension: 'txt',
+          isValid: true,
+        };
+      }
+    }
+    
+    // Process other object types
+    if (typeof content === 'object') {
+      return {
+        mimeType: 'application/json',
+        extension: 'json',
+        isValid: true,
+      };
+    }
+    
+    // Fallback
+    return {
+      mimeType: 'application/octet-stream',
+      extension: 'bin',
+      isValid: false,
+    };
+  };
+
+  // Handle row selection
+  const handleSelectCard = (card) => {
+    console.log("Selected card:", card.hash, "Content type:", card.contentType);
+    
+    // For image content, prepare it for display
+    let processedContent = card.content;
+    let contentType = card.contentType?.mimeType || 'application/octet-stream';
+    
+    // Special handling for Buffer content
+    if (card.content && typeof card.content === 'object' && card.content.type === 'Buffer' && Array.isArray(card.content.data)) {
+      // If it's an image, convert to a base64 data URL for direct display
+      if (contentType.startsWith('image/')) {
+        try {
+          const array = new Uint8Array(card.content.data);
+          const base64 = btoa(String.fromCharCode.apply(null, array));
+          processedContent = `data:${contentType};base64,${base64}`;
+          console.log("Converted image to data URL for display");
+        } catch (error) {
+          console.error("Error converting image to data URL:", error);
+        }
+      }
+      
+      // For text content that's in Buffer format
+      if (contentType === 'text/plain' && card.contentType?.decodedText) {
+        processedContent = card.contentType.decodedText;
+        console.log("Using decoded text content");
+      }
+    }
+    
+    dispatch(selectItem({
+      item: processedContent,
+      hash: card.hash,
+      contentType: contentType,
+      gtime: card.g_time
+    }));
+  };
+
+  // Handle sorting
+  const requestSort = (key) => {
+    const direction = sortConfig.key === key && sortConfig.direction === 'asc' ? 'desc' : 'asc';
+    setSortConfig({ key, direction });
+  };
+
+  // Apply sorting to cards
+  const sortedCards = React.useMemo(() => {
+    if (!sortConfig.key) return retrievedCards;
+    
+    return [...retrievedCards].sort((a, b) => {
+      // Null handling
+      if (a[sortConfig.key] === null) return sortConfig.direction === 'asc' ? -1 : 1;
+      if (b[sortConfig.key] === null) return sortConfig.direction === 'asc' ? 1 : -1;
+      
+      // String comparison
+      if (a[sortConfig.key] < b[sortConfig.key]) {
+        return sortConfig.direction === 'asc' ? -1 : 1;
+      }
+      if (a[sortConfig.key] > b[sortConfig.key]) {
+        return sortConfig.direction === 'asc' ? 1 : -1;
+      }
+      return 0;
+    });
+  }, [retrievedCards, sortConfig]);
+
+  // Function to get the sort indicator icon
+  const getSortIcon = (key) => {
+    if (sortConfig.key !== key) return null;
+    return sortConfig.direction === 'asc' ? ' ‚Üë' : ' ‚Üì';
+  };
+
+  return (
+    <div className="flex flex-col h-full overflow-hidden bg-background">
+      {/* Search and Controls */}
+      <div className="flex items-center gap-2 p-3 border-b border-neutral-200 dark:border-neutral-800">
+        <input
+          type="text"
+          value={searchQuery}
+          onChange={(e) => setSearchQuery(e.target.value)}
+          placeholder="Search cards..."
+          className="flex-1 px-3 py-2 rounded border border-neutral-300 dark:border-neutral-700 bg-transparent"
+        />
+        <button 
+          onClick={fetchCards}
+          className="px-3 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 transition-colors"
+        >
+          Search
+        </button>
+        <button 
+          onClick={() => setSearchQuery('')}
+          className="px-3 py-2 bg-gray-500 text-white rounded hover:bg-gray-600 transition-colors"
+        >
+          Clear
+        </button>
+      </div>
+
+      {/* Results Summary */}
+      <div className="px-4 py-2 text-sm">
+        <span className="text-gray-500">
+          {loading ? 'Loading...' : `Showing ${retrievedCards.length} of ${totalCount} cards`}
+        </span>
+      </div>
+
+      {/* Table */}
+      <div className="flex-1 overflow-auto">
+        <table className="min-w-full divide-y divide-neutral-200 dark:divide-neutral-800">
+          <thead className="bg-neutral-50 dark:bg-neutral-900">
+            <tr>
+              <th 
+                className="px-6 py-3 text-left text-xs font-medium text-neutral-500 uppercase tracking-wider cursor-pointer"
+                onClick={() => requestSort('hash')}
+              >
+                Hash {getSortIcon('hash')}
+              </th>
+              <th 
+                className="px-6 py-3 text-left text-xs font-medium text-neutral-500 uppercase tracking-wider cursor-pointer"
+                onClick={() => requestSort('g_time')}
+              >
+                G-Time {getSortIcon('g_time')}
+              </th>
+              <th 
+                className="px-6 py-3 text-left text-xs font-medium text-neutral-500 uppercase tracking-wider"
+              >
+                Type
+              </th>
+              <th 
+                className="px-6 py-3 text-left text-xs font-medium text-neutral-500 uppercase tracking-wider"
+              >
+                Size
+              </th>
+            </tr>
+          </thead>
+          <tbody className="divide-y divide-neutral-200 dark:divide-neutral-800">
+            {sortedCards.map((card) => (
+              <tr 
+                key={card.hash}
+                className={`hover:bg-neutral-100 dark:hover:bg-neutral-800 cursor-pointer ${
+                  selectedHash === card.hash ? 'bg-blue-50 dark:bg-blue-900/20' : ''
+                }`}
+                onClick={() => handleSelectCard(card)}
+              >
+                <td className="px-6 py-4 whitespace-nowrap text-sm">
+                  {card.hash.substring(0, 8)}...
+                </td>
+                <td className="px-6 py-4 whitespace-nowrap text-sm">
+                  {card.g_time || 'No timestamp'}
+                </td>
+                <td className="px-6 py-4 whitespace-nowrap">
+                  <div className="flex items-center">
+                    <FileTypeIcon 
+                      mimeType={card.contentType?.mimeType} 
+                      extension={card.contentType?.extension}
+                      size={20}
+                      className="mr-2"
+                    />
+                    <span className="text-sm">
+                      {card.contentType?.mimeType.split('/')[1] || 'unknown'}
+                    </span>
+                  </div>
+                </td>
+                <td className="px-6 py-4 whitespace-nowrap text-sm">
+                  {card.content?.data?.length ? `${card.content.data.length} bytes` : '‚Äî'}
+                </td>
+              </tr>
+            ))}
+          </tbody>
+        </table>
+      </div>
+      
+      {/* Loading Indicator */}
+      {loading && (
+        <div className="absolute inset-0 flex items-center justify-center bg-black/20">
+          <div className="animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"></div>
+        </div>
+      )}
+    </div>
+  );
+};
+
+export default FileTablePanel;
diff --git a/src/components/panels/Sidebar.astro b/src/components/panels/Sidebar.astro
index c3a400b..62d9aee 100644
--- a/src/components/panels/Sidebar.astro
+++ b/src/components/panels/Sidebar.astro
@@ -1,6 +1,6 @@
 ---
 import { cn } from '../../lib/utils';
-import { FaCode, FaSearch, FaBug, FaTerminal, FaCog, FaCube } from 'react-icons/fa';
+import { FaCode,FaTerminal, FaCog, FaCube, FaFile } from 'react-icons/fa';
 import { store } from '../../store';
 import { changeLayout } from '../../features/panellayoutSlice';
 
@@ -40,6 +40,16 @@ const { class: className, ...props } = Astro.props;
           CLM Editor
         </span>
       </button>
+      <button
+        id="fileLayoutBtn"
+        title="File Table View"
+        class="flex items-center justify-center w-12 h-12 hover:bg-muted-foreground/10 transition-colors group relative"
+      >
+        <FaFile className="text-lg text-muted-foreground group-hover:text-primary transition-colors" />
+        <span class="absolute left-full ml-2 bg-neutral-700 text-white text-xs px-2 py-1 rounded opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none">
+          File Table
+        </span>
+      </button>
     </div>
     <div>
       <div class="flex items-center justify-center w-12 h-12 hover:bg-muted-foreground/10 transition-colors">
@@ -57,6 +67,7 @@ const { class: className, ...props } = Astro.props;
   const todoLayoutBtn = document.getElementById('todoLayoutBtn');
   const generateLayoutBtn = document.getElementById('generateLayoutBtn');
   const clmLayoutBtn = document.getElementById('clmLayoutBtn');
+  const fileLayoutBtn = document.getElementById('fileLayoutBtn');
 
   // Add click handlers
   todoLayoutBtn?.addEventListener('click', () => {
@@ -71,17 +82,23 @@ const { class: className, ...props } = Astro.props;
     store.dispatch(changeLayout('clm_layout'));
   });
 
+  fileLayoutBtn?.addEventListener('click', () => {
+    store.dispatch(changeLayout('file_table_layout'));
+  });
+
   // Function to update active button styles
   function updateActiveButton(layout: string) {
     // Remove active styles from all buttons
     todoLayoutBtn?.classList.remove('border-l-2', 'border-primary', 'bg-muted');
     generateLayoutBtn?.classList.remove('border-l-2', 'border-primary', 'bg-muted');
     clmLayoutBtn?.classList.remove('border-l-2', 'border-primary', 'bg-muted');
+    fileLayoutBtn?.classList.remove('border-l-2', 'border-primary', 'bg-muted');
 
     // Reset icon colors
     todoLayoutBtn?.querySelector('.text-primary')?.classList.replace('text-primary', 'text-muted-foreground');
     generateLayoutBtn?.querySelector('.text-primary')?.classList.replace('text-primary', 'text-muted-foreground');
     clmLayoutBtn?.querySelector('.text-primary')?.classList.replace('text-primary', 'text-muted-foreground');
+    fileLayoutBtn?.querySelector('.text-primary')?.classList.replace('text-primary', 'text-muted-foreground');
 
     // Add active styles to the selected button
     if (layout === 'todo_layout') {
@@ -93,24 +110,26 @@ const { class: className, ...props } = Astro.props;
     } else if (layout === 'clm_layout') {
       clmLayoutBtn?.classList.add('border-l-2', 'border-primary', 'bg-muted');
       clmLayoutBtn?.querySelector('.text-muted-foreground')?.classList.replace('text-muted-foreground', 'text-primary');
+    } else if (layout === 'file_table_layout') {
+      fileLayoutBtn?.classList.add('border-l-2', 'border-primary', 'bg-muted');
+      fileLayoutBtn?.querySelector('.text-muted-foreground')?.classList.replace('text-muted-foreground', 'text-primary');
     }
   }
 
-  // Get the current layout from panels in the state
-  const getCurrentLayout = () => {
-    const state = store.getState() as any;
-    // Look at the panel configuration to determine which layout is active
+  // Function to determine current layout from state
+  const updateLayoutFromState = (state: any) => {
     const panels = state.panellayout.panels || { right: { type: 'TodoPanel' } };
     if (panels.right.type === 'GeneratePanel') return 'generate_layout';
     if (panels.right.type === 'CLMInputPanel') return 'clm_layout';
+    if (panels.middle?.type === 'CLMInputPanel' && panels.right?.type === 'ContentDetailPanel') return 'file_table_layout';
     return 'todo_layout';
   };
 
   // Initialize button state based on current layout
-  updateActiveButton(getCurrentLayout());
+  updateActiveButton(updateLayoutFromState(store.getState()));
 
   // Subscribe to store changes to update button states
   store.subscribe(() => {
-    updateActiveButton(getCurrentLayout());
+    updateActiveButton(updateLayoutFromState(store.getState()));
   });
 </script>
diff --git a/src/components/panels/database/Card.tsx b/src/components/panels/database/Card.tsx
index 82bcdaa..0b52d84 100644
--- a/src/components/panels/database/Card.tsx
+++ b/src/components/panels/database/Card.tsx
@@ -32,6 +32,41 @@ const isReduxStateData = (content: any): boolean => {
          content.includes('"redux"');
 };
 
+// TextPreview component for displaying text content
+const TextPreview: React.FC<{ content: any, maxLength?: number }> = ({ content, maxLength = 100 }) => {
+  let displayText = '';
+  
+  try {
+    // Handle Buffer JSON format
+    if (typeof content === 'object' && content?.type === 'Buffer' && Array.isArray(content?.data)) {
+      const array = new Uint8Array(content.data);
+      displayText = new TextDecoder().decode(array);
+    } 
+    // Handle plain text
+    else if (typeof content === 'string') {
+      displayText = content;
+    }
+    // Handle other objects
+    else if (content !== null && typeof content === 'object') {
+      displayText = JSON.stringify(content, null, 2);
+    }
+    // Handle other types
+    else if (content !== null && content !== undefined) {
+      displayText = String(content);
+    }
+  } catch (error) {
+    console.error("Error in TextPreview:", error);
+    displayText = "Error previewing content";
+  }
+  
+  // Truncate if needed
+  if (displayText.length > maxLength) {
+    displayText = displayText.substring(0, maxLength) + '...';
+  }
+  
+  return <pre className="whitespace-pre-wrap break-words text-xs font-mono">{displayText || 'No content'}</pre>;
+};
+
 export const Card: React.FC<CardProps> = ({ card, isSelected, onSelect, onContentTypeDetected }) => {
   const [contentType, setContentType] = useState<{
     mimeType?: string;
@@ -217,45 +252,44 @@ export const Card: React.FC<CardProps> = ({ card, isSelected, onSelect, onConten
 
   const truncatedHash = card.hash.substring(0, 8);
 
-  // Helper component to render text preview for Buffer JSON content
-  const TextPreview = ({ content }: { content: any }) => {
-    try {
-      // Convert Buffer JSON to text and display the first few lines
-      const array = new Uint8Array(content.data);
-      const text = new TextDecoder().decode(array);
-      const lines = text.split('\n').slice(0, 3); // Show up to 3 lines
-      
-      return (
-        <div className="text-preview">
-          {lines.map((line, i) => (
-            <div key={i} className="preview-line">{line}</div>
-          ))}
-          {text.split('\n').length > 3 && <div className="preview-more">...</div>}
+  return (
+    <div
+      className={`
+        mb-4 p-3
+        bg-white dark:bg-gray-800 
+        border-2 border-gray-200 dark:border-gray-700 
+        rounded-lg shadow-md 
+        ${isSelected ? 'ring-2 ring-blue-500 border-blue-500' : ''}
+      `}
+      onClick={() => onSelect(card)}
+    >
+      <div className="flex items-center">
+        {/* File Type Icon */}
+        <div className="flex-shrink-0 mr-3">
+          <FileTypeIcon
+            mimeType={contentType?.mimeType}
+            extension={contentType?.extension}
+            size={24}
+          />
         </div>
-      );
-    } catch (e) {
-      return <div className="preview-error">Cannot preview content</div>;
-    }
-  };
 
-  return (
-    <div className="card-component" onClick={handleClick}>
-      <div className="card-header">
-        {isSelected ? <p className="selected-indicator">‚úì</p> : null}
-        <p className="card-hash">{truncatedHash}...</p>
-        <p className="card-type">{getFileTypeLabel(contentType?.mimeType)}</p>
-        <p className="card-timestamp">{card.g_time}</p>
-      </div>
-      
-      {/* If item is selected, render a preview based on content type */}
-      {(isSelected && card.content && 
-          contentType?.mimeType === 'application/octet-stream' && 
-          typeof card.content === 'object' &&
-          card.content.type === 'Buffer') ? (
-        <div className="content-preview">
-          <TextPreview content={card.content} />
+        <div className="flex flex-col">
+          {/* Hash */}
+          <div className="text-md font-medium mb-1">
+            {card.hash.substring(0, 8)}...
+          </div>
+          
+          {/* File Type */}
+          <div className="text-sm text-gray-700 dark:text-gray-300 mb-1">
+            {getFileTypeLabel(contentType?.mimeType)}
+          </div>
+          
+          {/* Timestamp - display as plain string with no formatting */}
+          <div className="text-xs text-gray-500">
+            {card.g_time || 'No timestamp'}
+          </div>
         </div>
-      ) : null}
+      </div>
     </div>
   );
 };
diff --git a/src/components/panels/database/CardList.tsx b/src/components/panels/database/CardList.tsx
index b2140ed..1b03fbc 100644
--- a/src/components/panels/database/CardList.tsx
+++ b/src/components/panels/database/CardList.tsx
@@ -69,37 +69,38 @@ export const CardList: React.FC<CardListProps> = ({
     );
   }
 
-  if (!cards || cards.items.length === 0) {
-    return (
-      <div className="text-center text-gray-500 p-4">
-        {cards ? 'No cards found' : 'Enter search terms or fetch cards'}
-      </div>
-    );
-  }
-
   return (
     <div className="p-4">
-      {/* Results Summary */}
-      <div className="mb-2">
-        <p className="text-sm text-gray-700">
-          {cards.retrievalMethod === 'hash'
-            ? 'Card found by hash'
-            : `Showing ${cards.items.length} of ${cards.total_items} cards`}
-          {cards.serverTimestamp && ` (as of ${formatDate(cards.serverTimestamp)})`}
-        </p>
-      </div>
-
-      <div className="space-y-2 mb-4">
-        {cards.items.map((card) => (
-          <Card
-            key={card.hash}
-            card={card}
-            isSelected={selectedCardHash === card.hash}
-            onSelect={onSelectCard}
-            onContentTypeDetected={handleContentTypeDetected}
-          />
-        ))}
-      </div>
+      {!cards || cards.items.length === 0 ? (
+        <div className="text-gray-500 text-center py-8">No cards available.</div>
+      ) : (
+        <>
+          <p className="text-sm text-gray-500 mb-4">
+            {cards.retrievalMethod === 'hash'
+              ? 'Card found by hash'
+              : `Showing ${cards.items.length} of ${cards.total_items} cards`}
+            {cards.serverTimestamp && ` (as of ${formatDate(cards.serverTimestamp)})`}
+          </p>
+          
+          <div className="grid grid-cols-1 gap-4">
+            {cards.items.map((card) => (
+              <Card
+                key={card.hash}
+                card={card}
+                isSelected={selectedCardHash === card.hash}
+                onSelect={onSelectCard}
+                onContentTypeDetected={handleContentTypeDetected}
+              />
+            ))}
+          </div>
+        </>
+      )}
+      
+      {loading && (
+        <div className="flex justify-center mt-4">
+          <div className="animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-blue-500"></div>
+        </div>
+      )}
     </div>
   );
 };
diff --git a/src/components/viewers/ContentViewer.jsx b/src/components/viewers/ContentViewer.jsx
index e4456cd..6d51743 100644
--- a/src/components/viewers/ContentViewer.jsx
+++ b/src/components/viewers/ContentViewer.jsx
@@ -14,6 +14,7 @@ import PDFViewer from './PDFViewer';
 import VideoViewer from './VideoViewer';
 import MOVViewer from './MOVViewer';
 import AudioViewer from './AudioViewer';
+import EnhancedImageViewer from './EnhancedImageViewer';
 
 // Component map to avoid dynamic imports that Vite can't handle
 const COMPONENT_MAP = {
@@ -26,6 +27,7 @@ const COMPONENT_MAP = {
   'VideoViewer.jsx': VideoViewer,
   'MOVViewer.jsx': MOVViewer,
   'AudioViewer.jsx': AudioViewer,
+  'EnhancedImageViewer.jsx': EnhancedImageViewer,
   // Add other components as they are created
 };
 
diff --git a/src/components/viewers/EnhancedImageViewer.jsx b/src/components/viewers/EnhancedImageViewer.jsx
new file mode 100644
index 0000000..a34d1c7
--- /dev/null
+++ b/src/components/viewers/EnhancedImageViewer.jsx
@@ -0,0 +1,169 @@
+'use client';
+
+import React, { useState, useEffect } from 'react';
+
+/**
+ * Enhanced image viewer with zoom capabilities and improved Buffer handling
+ */
+const EnhancedImageViewer = ({ content, contentType }) => {
+  const [imageUrl, setImageUrl] = useState('');
+  const [loading, setLoading] = useState(true);
+  const [error, setError] = useState(null);
+  const [zoom, setZoom] = useState(100);
+  const [imageInfo, setImageInfo] = useState({ width: 0, height: 0, format: 'unknown' });
+
+  useEffect(() => {
+    const processImageContent = async () => {
+      setLoading(true);
+      setError(null);
+      
+      try {
+        // Case 1: Content is already a data URL
+        if (typeof content === 'string' && content.startsWith('data:image')) {
+          console.log("EnhancedImageViewer: Using direct data URL");
+          setImageUrl(content);
+          return;
+        }
+        
+        // Case 2: Content is a Buffer JSON object
+        if (content && typeof content === 'object' && content.type === 'Buffer' && Array.isArray(content.data)) {
+          try {
+            const array = new Uint8Array(content.data);
+            // Determine the MIME type from contentType or default to a generic image type
+            const mimeType = contentType?.mimeType || 'image/png';
+            const base64 = btoa(String.fromCharCode.apply(null, array));
+            const dataUrl = `data:${mimeType};base64,${base64}`;
+            console.log(`EnhancedImageViewer: Converted buffer to data URL (${mimeType})`);
+            setImageUrl(dataUrl);
+            return;
+          } catch (err) {
+            console.error("Error converting buffer to image:", err);
+            setError("Failed to convert buffer data to an image");
+            return;
+          }
+        }
+        
+        // Case 3: Content is a base64 string without the data URL prefix
+        if (typeof content === 'string' && /^[A-Za-z0-9+/=]+$/.test(content)) {
+          try {
+            const mimeType = contentType?.mimeType || 'image/png';
+            const dataUrl = `data:${mimeType};base64,${content}`;
+            console.log("EnhancedImageViewer: Using base64 string directly");
+            setImageUrl(dataUrl);
+            return;
+          } catch (err) {
+            console.error("Error converting base64 to image:", err);
+            setError("Failed to convert base64 data to an image");
+            return;
+          }
+        }
+        
+        // If we get here, we don't know how to handle the content
+        console.error("EnhancedImageViewer: Unsupported content format", typeof content);
+        setError("Unsupported image format");
+      } catch (err) {
+        console.error("Error in image processing:", err);
+        setError(`Image processing error: ${err.message}`);
+      } finally {
+        setLoading(false);
+      }
+    };
+    
+    processImageContent();
+  }, [content, contentType]);
+  
+  // Get image dimensions once it loads
+  const handleImageLoad = (e) => {
+    setLoading(false);
+    setImageInfo({
+      width: e.target.naturalWidth,
+      height: e.target.naturalHeight,
+      format: contentType?.mimeType?.split('/')[1] || 'unknown'
+    });
+  };
+  
+  const handleZoomIn = () => setZoom(prev => Math.min(prev + 25, 400));
+  const handleZoomOut = () => setZoom(prev => Math.max(prev - 25, 25));
+  const handleResetZoom = () => setZoom(100);
+
+  return (
+    <div className="h-full flex flex-col">
+      {/* Controls */}
+      <div className="flex items-center justify-between p-2 bg-gray-100 dark:bg-gray-800">
+        <div className="flex items-center space-x-2">
+          <button 
+            onClick={handleZoomOut}
+            className="p-1 rounded bg-gray-200 hover:bg-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600"
+            title="Zoom out"
+          >
+            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
+              <circle cx="11" cy="11" r="8"></circle>
+              <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
+              <line x1="8" y1="11" x2="14" y2="11"></line>
+            </svg>
+          </button>
+          <span className="text-sm">{zoom}%</span>
+          <button 
+            onClick={handleZoomIn}
+            className="p-1 rounded bg-gray-200 hover:bg-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600"
+            title="Zoom in"
+          >
+            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
+              <circle cx="11" cy="11" r="8"></circle>
+              <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
+              <line x1="11" y1="8" x2="11" y2="14"></line>
+              <line x1="8" y1="11" x2="14" y2="11"></line>
+            </svg>
+          </button>
+          <button 
+            onClick={handleResetZoom}
+            className="text-xs px-2 py-1 rounded bg-gray-200 hover:bg-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600"
+            title="Reset zoom"
+          >
+            Reset
+          </button>
+        </div>
+        
+        {!loading && !error && (
+          <div className="text-xs text-gray-500">
+            {imageInfo.width} √ó {imageInfo.height} {imageInfo.format}
+          </div>
+        )}
+      </div>
+      
+      {/* Image container */}
+      <div className="flex-1 overflow-auto flex items-center justify-center bg-neutral-100 dark:bg-neutral-900 bg-grid-pattern">
+        {loading && (
+          <div className="flex flex-col items-center justify-center p-8 text-gray-500">
+            <div className="w-12 h-12 border-t-2 border-b-2 border-blue-500 rounded-full animate-spin mb-4"></div>
+            <p>Loading image...</p>
+          </div>
+        )}
+        
+        {error && (
+          <div className="max-w-md p-6 text-center text-red-500 bg-red-50 dark:bg-red-900/20 rounded-lg">
+            <svg xmlns="http://www.w3.org/2000/svg" className="w-12 h-12 mx-auto mb-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
+              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
+            </svg>
+            <h3 className="text-lg font-medium mb-2">Image Error</h3>
+            <p>{error}</p>
+          </div>
+        )}
+        
+        {!loading && !error && imageUrl && (
+          <div className="relative max-h-full overflow-auto p-4">
+            <img 
+              src={imageUrl} 
+              alt="Image content" 
+              style={{ transform: `scale(${zoom / 100})`, transformOrigin: 'center' }}
+              className="transition-transform duration-200 max-w-none" 
+              onLoad={handleImageLoad}
+            />
+          </div>
+        )}
+      </div>
+    </div>
+  );
+};
+
+export default EnhancedImageViewer;
diff --git a/src/components/viewers/TXTViewer.jsx b/src/components/viewers/TXTViewer.jsx
new file mode 100644
index 0000000..613ad70
--- /dev/null
+++ b/src/components/viewers/TXTViewer.jsx
@@ -0,0 +1,182 @@
+// src/components/viewers/TXTViewer.jsx
+import React, { useState, useEffect } from 'react';
+import { TextViewer } from './TextViewer';
+import { FiZoomIn, FiZoomOut, FiAlignLeft, FiList, FiToggleRight } from 'react-icons/fi';
+
+/**
+ * Enhanced viewer for plain text files with additional features:
+ * - Line numbering (toggleable)
+ * - Font size controls (xs, sm, base, lg)
+ * - Word wrap toggle
+ * - Basic syntax highlighting for URLs, emails, and dates
+ */
+export const TXTViewer = ({ content }) => {
+  // Extract text content from various formats
+  const [processedContent, setProcessedContent] = useState('');
+  const [showLineNumbers, setShowLineNumbers] = useState(true);
+  const [fontSize, setFontSize] = useState('base'); // xs, sm, base, lg
+  const [wordWrap, setWordWrap] = useState(true);
+  
+  // Process the content once when component mounts or content changes
+  useEffect(() => {
+    let textContent = '';
+    
+    // First, check if we already have a plain string (from server-side processing)
+    if (typeof content === 'string') {
+      textContent = content;
+    } 
+    // If we get a Buffer JSON format, decode it
+    else if (content && typeof content === 'object') {
+      if (content.type === 'base64' && content.data) {
+        // Base64 format from API
+        try {
+          // Convert base64 to string
+          const binary = atob(content.data);
+          const array = new Uint8Array(binary.length);
+          for (let i = 0; i < binary.length; i++) {
+            array[i] = binary.charCodeAt(i);
+          }
+          textContent = new TextDecoder().decode(array);
+        } catch (e) {
+          console.error('Error decoding base64 content:', e);
+          textContent = `[Error decoding content: ${e.message}]`;
+        }
+      }
+      else if (content.type === 'Buffer' && Array.isArray(content.data)) {
+        // Legacy Buffer JSON format
+        try {
+          const array = new Uint8Array(content.data);
+          textContent = new TextDecoder().decode(array);
+        } catch (e) {
+          console.error('Error decoding Buffer content:', e);
+          textContent = `[Error decoding content: ${e.message}]`;
+        }
+      }
+      else {
+        // Other object types - stringify with formatting
+        textContent = JSON.stringify(content, null, 2);
+      }
+    }
+    else {
+      // Fallback for other types
+      textContent = String(content || '');
+    }
+    
+    setProcessedContent(textContent);
+  }, [content]);
+  
+  // Function to apply syntax highlighting
+  const highlightSyntax = (text) => {
+    if (!text) return '';
+    
+    const lines = text.split('\n');
+    
+    // Apply basic syntax highlighting to each line
+    return lines.map((line, index) => {
+      // Highlight URLs
+      let highlightedLine = line.replace(
+        /(https?:\/\/[^\s]+)/g, 
+        '<span class="text-blue-600 underline">$1</span>'
+      );
+      
+      // Highlight email addresses
+      highlightedLine = highlightedLine.replace(
+        /([a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,})/g,
+        '<span class="text-green-600">$1</span>'
+      );
+      
+      // Highlight dates (simple pattern - could be expanded)
+      highlightedLine = highlightedLine.replace(
+        /\b(\d{4}[-/]\d{1,2}[-/]\d{1,2})\b/g,
+        '<span class="text-purple-600">$1</span>'
+      );
+      
+      return (
+        <div key={index} className="flex">
+          {showLineNumbers && (
+            <div className="text-gray-400 text-right pr-4 select-none w-12 flex-shrink-0 border-r border-gray-200 dark:border-gray-700">
+              {index + 1}
+            </div>
+          )}
+          <div 
+            dangerouslySetInnerHTML={{ __html: highlightedLine }} 
+            className="flex-grow"
+          />
+        </div>
+      );
+    });
+  };
+  
+  // Font size classes
+  const fontSizeClasses = {
+    'xs': 'text-xs',
+    'sm': 'text-sm',
+    'base': 'text-base',
+    'lg': 'text-lg',
+  };
+  
+  return (
+    <div className="flex flex-col h-full">
+      {/* Control toolbar */}
+      <div className="flex items-center gap-4 p-2 border-b border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800">
+        {/* Line number toggle */}
+        <button 
+          onClick={() => setShowLineNumbers(prev => !prev)} 
+          className={`p-1 rounded ${showLineNumbers ? 'bg-blue-100 text-blue-800' : 'text-gray-600 hover:bg-gray-200'}`}
+          title={showLineNumbers ? "Hide line numbers" : "Show line numbers"}
+        >
+          <FiList />
+        </button>
+        
+        {/* Word wrap toggle */}
+        <button 
+          onClick={() => setWordWrap(prev => !prev)} 
+          className={`p-1 rounded ${wordWrap ? 'bg-blue-100 text-blue-800' : 'text-gray-600 hover:bg-gray-200'}`}
+          title={wordWrap ? "Disable word wrap" : "Enable word wrap"}
+        >
+          <FiAlignLeft />
+        </button>
+        
+        {/* Font size controls */}
+        <div className="flex items-center gap-1">
+          <button 
+            onClick={() => setFontSize(prev => prev === 'xs' ? 'xs' : 
+              prev === 'sm' ? 'xs' : 
+              prev === 'base' ? 'sm' : 
+              'base')} 
+            className="p-1 rounded text-gray-600 hover:bg-gray-200"
+            title="Decrease font size"
+            disabled={fontSize === 'xs'}
+          >
+            <FiZoomOut />
+          </button>
+          
+          <span className="text-xs text-gray-500 px-1">
+            {fontSize.toUpperCase()}
+          </span>
+          
+          <button 
+            onClick={() => setFontSize(prev => prev === 'lg' ? 'lg' : 
+              prev === 'base' ? 'lg' : 
+              prev === 'sm' ? 'base' : 
+              'sm')} 
+            className="p-1 rounded text-gray-600 hover:bg-gray-200"
+            title="Increase font size"
+            disabled={fontSize === 'lg'}
+          >
+            <FiZoomIn />
+          </button>
+        </div>
+      </div>
+      
+      {/* Text content */}
+      <div 
+        className={`font-mono ${fontSizeClasses[fontSize]} overflow-auto max-h-full bg-white dark:bg-gray-900 p-4 flex-1 ${wordWrap ? 'whitespace-pre-wrap' : 'whitespace-pre overflow-x-auto'}`}
+      >
+        {highlightSyntax(processedContent)}
+      </div>
+    </div>
+  );
+};
+
+export default TXTViewer;
diff --git a/src/config/content-type-viewers.json b/src/config/content-type-viewers.json
index 12bca16..7f32b37 100644
--- a/src/config/content-type-viewers.json
+++ b/src/config/content-type-viewers.json
@@ -14,22 +14,24 @@
     },
     
     "image/jpeg": {
-      "component": "JPGViewer.jsx",
-      "priority": 100
+      "component": "EnhancedImageViewer.jsx",
+      "priority": 150,
+      "fallback": "JPGViewer.jsx"
     },
     "image/png": {
-      "component": "PNGViewer.jsx",
-      "priority": 100,
-      "fallback": "BinaryViewer.jsx"
+      "component": "EnhancedImageViewer.jsx",
+      "priority": 150,
+      "fallback": "PNGViewer.jsx"
     },
     "image/gif": {
-      "component": "GIFViewer.jsx",
-      "priority": 100
+      "component": "EnhancedImageViewer.jsx",
+      "priority": 150,
+      "fallback": "GIFViewer.jsx"
     },
     "image/svg+xml": {
-      "component": "SVGViewer.jsx",
-      "priority": 100,
-      "fallback": "BinaryViewer.jsx"
+      "component": "EnhancedImageViewer.jsx",
+      "priority": 150,
+      "fallback": "SVGViewer.jsx"
     },
     
     "video/quicktime": {
diff --git a/src/features/panellayoutSlice.json b/src/features/panellayoutSlice.json
index 963eacc..a9e2573 100644
--- a/src/features/panellayoutSlice.json
+++ b/src/features/panellayoutSlice.json
@@ -58,5 +58,26 @@
             "minSize": 20,
             "visible": true
         }
+    },
+    "file_table_layout": {
+        "left": {
+            "type": "FileTablePanel",
+            "size": 50,
+            "minSize": 30,
+            "visible": true
+        },
+        "middle": {
+            "type": "ContentViewerPanel", 
+            "size": 0,
+            "minSize": 0,
+            "visible": false
+        },
+        "right": {
+            "type": "ContentDetailPanel",
+            "size": 50,
+            "minSize": 30,
+            "visible": true
+        }
     }
+    
 }
```
